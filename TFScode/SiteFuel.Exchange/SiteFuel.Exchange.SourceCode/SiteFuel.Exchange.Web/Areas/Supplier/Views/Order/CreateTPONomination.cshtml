@model ThirdPartyOrderViewModel
@using System.ComponentModel.DataAnnotations
@{
    if (Model.IsCloneOrder)
    {
        ViewBag.Title = !Model.FuelDetails.IsMarineLocation ? "Clone Order" : "Clone Nomination";
    }
    else
    {
        ViewBag.Title = "Create Nomination";
    }
}
<script src="~/Content/js/common-supplier.js"></script>

<div class="row mb10">
    
</div>

@using (Html.BeginForm("CreateTPONomination", "Order", new { area = "Supplier" }, FormMethod.Post, new { enctype = "multipart/form-data", @id = "createOrderForm" }))
{
    @Html.HiddenFor(m => m.FuelDeliveryDetails.IsOrderEndDateRequired)
    @Html.HiddenFor(m => m.IsOnboardingPreferenceExists)

    if (Model.IsOnboardingPreferenceExists && Model.PreferencesSetting != null)
    {
        @Html.HiddenFor(m => m.PreferencesSetting.PreferencePricingMethod)
        @Html.HiddenFor(m => m.PreferencesSetting.IsSupressOrderPricing)
        @Html.HiddenFor(m => m.PreferencesSetting.Id)
    }
    @Html.HiddenFor(m => m.FuelDetails.IsMarineLocation)
    @Html.HiddenFor(m => m.AddressDetails.IsMarineLocation, new { @class = "IsMarineLocation" })
    @Html.HiddenFor(m => m.DefaultInvoiceType)
    <div class="row">
        <div class="col-sm-9">
            <div class="tab-container">
                <div id="tpo-details" class="subTabs animated fadeIn">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-sm-12">
                                    <h4>@Resource.headingCustomerInformation</h4>
                                    <!-- customer details starts -->
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="custom-control custom-radio custom-control-inline radio">
                                                @Html.RadioButtonFor(m => m.CustomerDetails.IsNewCompany, true, new { @id = "radio-newcustomer", @class = "custom-control-input", onclick = "inputBoxShowHide('new-CompanyName','existing-CompanyName')", onchange = "isExistingCompanyRadioSelected(false);" })
                                                <label class="custom-control-label" for="radio-newcustomer">@Resource.lblNew</label>
                                            </div>
                                            <div class="custom-control custom-radio custom-control-inline radio">
                                                @Html.RadioButtonFor(m => m.CustomerDetails.IsNewCompany, false, new { @id = "radio-existingcustomer", @class = "custom-control-input", onclick = "inputBoxShowHide('existing-CompanyName','new-CompanyName')", onchange = "isExistingCompanyRadioSelected(true);" })
                                                <label class="custom-control-label" for="radio-existingcustomer">@Resource.lblExisting</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-sm-4 col-md-3">
                                            <div class="form-group mb0">
                                                @Html.HiddenFor(m => m.CustomerDetails.IsNewCompany)
                                                @*@Html.HiddenFor(m => m.CustomerDetails.CompanyId)*@
                                                @Html.LabelFor(m => m.CustomerDetails.CompanyName)
                                                <div class="mtm1 new-CompanyName">
                                                    @Html.TextBoxFor(m => m.CustomerDetails.CompanyName, new { @class = "form-control", @placeholder = Resource.lblCompany })
                                                    @Html.ValidationMessageFor(m => m.CustomerDetails.CompanyName)
                                                </div>
                                                <div class="existing-CompanyName defaultDisabled">                                                    
                                                    @Html.DropDownListFor(m => m.CustomerDetails.CompanyId, new SelectList(new List<DropdownDisplayItem>()), string.Format(Resource.valMessageSelect, Resource.lblCompany), new { @class = "form-control selectCompany", onchange = "isExistingCompanyRadioSelected(true);" })

                                                    @Html.ValidationMessageFor(m => m.CustomerDetails.CompanyId)
                                                </div>

                                                <div class="pa bg-white top0 left0 z-index5 loading-wrapper tpo-company-loader mtm10 hide"><span class='spinner-dashboard pa'></span></div>
                                            </div>
                                        </div>
                                        <div class="col-sm-8 col-md-9">
                                            <div class="row">
                                                <div class="col-sm-4 new-company">
                                                    <div class="form-group">
                                                        <div id="newContactPersonInput">
                                                            @Html.LabelFor(m => m.CustomerDetails.Name)
                                                            @Html.TextBoxFor(m => m.CustomerDetails.Name, new { @class = "form-control newContactPerson", @placeholder = "John Smith" })
                                                            <a id="useExisting" onclick="CreateExistingContactPerson()" class="hide-element"><span class="fa fa-arrow-left mt7"></span> @Resource.btnLabelUseExisting</a>
                                                            @Html.ValidationMessageFor(m => m.CustomerDetails.Name)
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4 existing-company disabled">
                                                    <div class="pa bg-white top0 left0 z-index5 loading-wrapper customer-contact hide-element"><span class='spinner-dashboard pa'></span></div>
                                                    <div class="form-group">
                                                        <div id="existingContactPersonDropdown">
                                                            @Html.LabelFor(m => m.CustomerDetails.Name)
                                                            @Html.DropDownListFor(m => m.CustomerDetails.UserId, new SelectList(new List<DropdownDisplayItem>
                                                                (), "Id", "Name", Model.CustomerDetails.Name), string.Format(Resource.valMessageSelect, Resource.lblContactPerson), new { @class = "form-control existingContactPerson", onchange = "GetContactPersonDetails(this)" })
                                                            <a id="createNew" onclick="CreateNewContactPerson()"><span class="fa fa-plus-circle mt7"></span> @Resource.btnLabelCreateNew</a>
                                                            @Html.ValidationMessageFor(m => m.CustomerDetails.UserId)
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.CustomerDetails.PhoneNumber)
                                                        @Html.TextBoxFor(m => m.CustomerDetails.PhoneNumber, new { @class = "form-control input-phoneformat phoneNumber", onchange = "IsPhoneNumberValid(this.value)" })
                                                        @Html.ValidationMessageFor(m => m.CustomerDetails.PhoneNumber)
                                                        <div class="color-orange fs12 pt5" id="mobile-validation-msg"></div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4">
                                                    <div class="form-group custEmail">
                                                        @Html.LabelFor(m => m.CustomerDetails.Email)
                                                        @Html.TextBoxFor(m => m.CustomerDetails.Email, new { @class = "form-control email" })
                                                        @Html.ValidationMessageFor(m => m.CustomerDetails.Email)
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- customer details ends -->
                                </div>
                                <div class="col-sm-12">
                                    <div class="row mb10">
                                        <div class="col-sm-3">
                                            <div class="checkbox mb0">
                                                <label id="sales-tax-exempt">
                                                    @Html.CheckBoxFor(m => m.IsTaxExempted) @Resource.lblTaxExempted
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15 job-section">
                                <div class="col-sm-12">
                                    <h4 class="job-site-info">@Resource.headingPortOrDeliveryLocation</h4>
                                    <div class="row">
                                        <div class="col-sm-2">
                                            <div class="form-group">
                                                <label>@Resource.lblCountry</label>
                                                @Html.DropDownListFor(m => m.AddressDetails.Country.Id, new SelectList(CommonHelperMethods.GetCountriesEx(), "Id", "Code", Model.AddressDetails.Country.Id), new { @id = "country-filter", @name = "country-filter", @class = "form-control", onchange = "getPortsByCountry(this);removeRegionValidation();" })
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-4 hide-element">
                                            <div class="form-check form-check-inline radio  tpo-enabled">
                                                @Html.RadioButtonFor(m => m.AddressDetails.IsNewJob, true, new { @id = "radio-newjob", @class = "jobname form-check-input", onclick = "inputBoxShowHide('new-job','existing-job');enableSection('address-controls');enableElement('billing-control,billing-address-controls')", onchange = "focusOnFirst(this, 'new-job');isExistingJobRadioSelected(true);" })
                                                <label class="form-check-label" for="radio-newjob">@Resource.lblNew</label>
                                            </div>
                                            <div class="form-check form-check-inline existingjobSection radio">
                                                @Html.RadioButtonFor(m => m.AddressDetails.IsNewJob, false, new { @id = "radio-existingjob", @class = "jobname existingjob form-check-input", onclick = "inputBoxShowHide('existing-job','new-job');disableSection('address-controls');disableElement('billing-control,billing-address-controls')", onchange = "focusOnFirst(this, 'existing-job');isExistingJobRadioSelected(false);" })
                                                <label class="form-check-label" for="radio-existingjob">@Resource.lblExisting</label>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="new-job">
                                                @Html.LabelFor(m => m.AddressDetails.JobName, new { @class = "job-site-info" })
                                                @Html.TextBoxFor(m => m.AddressDetails.JobName, new { @class = "form-control" })
                                                @Html.ValidationMessageFor(m => m.AddressDetails.JobName)
                                            </div>
                                            <div class="existing-job defaultDisabled">
                                                <label>@Resource.lblPortName</label>
                                                @Html.DropDownListFor(m => m.AddressDetails.JobId, new SelectList(CommonHelperMethods.GetJobList(Model.CustomerDetails.CompanyName, false, true, CurrentUser.Id, CurrentUser.CompanyId, true, Model.AddressDetails.Country.Id).OrderBy(top => top.Name).ToList(), "Id", "Name", Model.AddressDetails.JobId), string.Format(Resource.valMessageSelect, Resource.lblPort), new { @class = "form-control selectExistingJobId", onchange = "isExistingJobRadioSelected(true);" })
                                                @Html.ValidationMessageFor(m => m.AddressDetails.JobId)
                                            </div>
                                            <div class="hide-element">
                                                @Html.TextBoxFor(m => m.AddressDetails.DisplayJobID, new { @class = "form-control" })
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="row">
                                                <div class="col-md-8">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.OrderAdditionalDetailsViewModel.Berth)
                                                        @Html.TextBoxFor(m => m.OrderAdditionalDetailsViewModel.Berth, new { @class = "form-control" })
                                                        @Html.ValidationMessageFor(m => m.OrderAdditionalDetailsViewModel.Berth)
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            @Html.PartialFor("~/Views/Shared/_PartialCompanyCurrency.cshtml", m => m.AddressDetails.Country)
                                        </div>
                                    </div>
                                    <div class="address-container hide-element">
                                        <div class="row">
                                            <div class="col-sm-2">
                                                <div class="form-group">
                                                    @Html.HiddenFor(m => m.AddressDetails.Country.Name, new { @Value = Resource.lblDummy })
                                                    @Html.HiddenFor(m => m.AddressDetails.Country.Code, new { @Value = Resource.lblDummy })
                                                    @*@Html.HiddenFor(m => m.AddressDetails.CountyName, new { @Value = Resource.lblDummy, @class = "county" })*@
                                                    @Html.LabelFor(m => m.AddressDetails.Country.Id)
                                                    @Html.DropDownListFor(m => m.AddressDetails.Country.Id, new SelectList(CommonHelperMethods.GetCountriesEx(), "Id", "Code", Model.AddressDetails.Country.Id), new { @class = "form-control country addressInput" })
                                                    @Html.ValidationMessageFor(m => m.AddressDetails.Country.Id)
                                                </div>
                                            </div>
                                            <div class="col-sm-3 countrygroup-div hide-element">
                                                <div class="form-group">
                                                    @Html.Label(Resource.lblCountryGroup)
                                                    @Html.DropDownListFor(m => m.AddressDetails.CountryGroupId, new SelectList(CommonHelperMethods.GetCountriesGroupEx(4), "Id", "Name"), Resource.btnLabelSelect, new { @class = "form-control countrygroup addressInput defaultDisabled" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <div class="row address-controls">
                                                    <div class="col-sm-5">
                                                        <div class="row">
                                                            <div class="col-md-6 mfn-uom-section hide-element">
                                                                <div class="form-group">
                                                                    @Html.LabelFor(m => m.AddressDetails.Country.UoM) <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.lblUoM" data-original-title="@Resource.lblUoM"></i>
                                                                    @Html.DropDownListFor(m => m.AddressDetails.MarineUoM, new SelectList(CommonHelperMethods.GetUoMList(), "Id", "Code", (int)Model.AddressDetails.MarineUoM), new { @class = "form-control marine-uom " })
                                                                    @Html.ValidationMessageFor(m => m.AddressDetails.MarineUoM)
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row mt20">
                                            <div class="col-sm-12">
                                                <div class="row">
                                                    <div class="col-sm-12">
                                                        <div>
                                                            <label class="checkbox-inline ftl-controls hide-element">
                                                                @Html.CheckBoxFor(m => m.AddressDetails.IsVarious, new { @value = Model.AddressDetails.IsVarious, @checked = Model.AddressDetails.IsVarious, onclick = "showHideControls(this,'wrapper-various','wrapper-location');" })
                                                                @Resource.lblVarious
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-7">
                                                        <div class="wrapper-location">
                                                            <div class="address-controls">
                                                                <div class="row combineDiv">
                                                                    <div class="col-sm-8">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.Address)<span class="required pl4 mandatory-symbol" aria-required="true">*</span>
                                                                            @Html.TextBoxFor(m => m.AddressDetails.Address, new { @class = "form-control address addressInput address-type" })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.Address)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorAddress"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-4">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.ZipCode)<span class="required pl4 mandatory-symbol" aria-required="true">*</span>
                                                                            @Html.TextBoxFor(m => m.AddressDetails.ZipCode, new { @class = "form-control zipcode addressInput address-type" })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.ZipCode)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorZipCode"></span>
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                                <div class="row combineDiv">
                                                                    <div class="col-sm-4">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.City)<span class="required pl4 mandatory-symbol" aria-required="true">*</span>
                                                                            @Html.TextBoxFor(m => m.AddressDetails.City, new { @class = "form-control city addressInput address-type" })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.City)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorCity"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-4">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.CountyName)<span class="required pl4 mandatory-symbol" aria-required="true">*</span>
                                                                            <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.msgCountyNameReason"></i>
                                                                            @Html.TextBoxFor(m => m.AddressDetails.CountyName, new { @class = "form-control county addressInput address-type" })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.CountyName)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorCountyName"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-sm-4">
                                                                        <div class="form-group">
                                                                            @Html.HiddenFor(m => m.AddressDetails.State.Name, new { @Value = Resource.lblDummy })
                                                                            @Html.HiddenFor(m => m.AddressDetails.State.Code, new { @Value = Resource.lblDummy })
                                                                            @Html.LabelFor(m => m.AddressDetails.State.Id)<span class="required pl4" aria-required="true">*</span>
                                                                            @Html.DropDownListFor(m => m.AddressDetails.State.Id, new SelectList(new List<DropdownDisplayItem>
                                                                                ()), string.Format(Resource.valMessageSelect, Resource.lblState), new { @class = "form-control state addressInput triggerTerminalChange", onchange = "setStateValue(this);" })
                                                                            @Html.ValidationMessageFor(m => m.AddressDetails.State.Id)
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-md-12">
                                                                        <div class="form-check form-group form-check-inline">
                                                                            @Html.CheckBoxFor(m => m.AddressDetails.IsGeocodeUsed, new { @id = "checkbox-geocodes", @class = "form-check-input", onclick = "setReadOnlyMode(this,'geoInput','addressInput'); setControlsEditableForCaribbean(this);" })
                                                                            <label class="form-check-label" for="checkbox-geocodes">@Resource.lblGeoCodes</label>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xs-6 col-md-4 combineDiv subSectionOpacity">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.Latitude)
                                                                            @Html.TextBoxFor(m => m.AddressDetails.Latitude, new { @class = "form-control datatype-decimal mask-decimal latitude geoInput defaultDisabled address-type", @readonly = "true" })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.Latitude)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorLatitude"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-xs-6 col-md-4 combineDiv subSectionOpacity">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.Longitude)
                                                                            @Html.TextBoxFor(m => m.AddressDetails.Longitude, new
                                                                            {
                                                                            @class = "form-control datatype-decimal mask-decimal longitude geoInput defaultDisabled address-type",
                                                                            @readonly = "true"
                                                                            })
                                                                            @*@Html.ValidationMessageFor(m => m.AddressDetails.Longitude)*@
                                                                            <span class="field-validation-error hide-element address-validation-error" id="spnErrorLongitude"></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-4">
                                                                        <div class="form-group">
                                                                            @Html.LabelFor(m => m.AddressDetails.TimeZoneName)
                                                                            @Html.TextBoxFor(m => m.AddressDetails.TimeZoneName, new { @class = "form-control timeZoneName defaultDisabled", @readonly = "true" })
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="wrapper-various hide-element">
                                                            <div id="address-controls" class="address-controls row">
                                                                <div class="col-sm-5">
                                                                    <div class="form-group">
                                                                        @Html.HiddenFor(m => m.AddressDetails.State.Name, new { @Value = Resource.lblDummy })
                                                                        @Html.HiddenFor(m => m.AddressDetails.State.Code, new { @Value = Resource.lblDummy })
                                                                        @Html.LabelFor(m => m.AddressDetails.State.Id)
                                                                        @Html.DropDownListFor(m => m.AddressDetails.State.Id, new SelectList(new List<DropdownDisplayItem>
                                                                            ()), string.Format(Resource.valMessageSelect, Resource.lblState), new { @class = "form-control state addressInput", onchange = "setStateValue(this);" })
                                                                        @Html.ValidationMessageFor(m => m.AddressDetails.State.Id)
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-5">
                                                        <div id="job-map" class="map-wrapper map-controls">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- fuel request starts -->
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-sm-12">
                                    <div class="row">
                                        <disv class="col-md-12 disable-in-tpo-edit fuel-display-group ">
                                            <h4 class="mb0 pb10">@Resource.lblFuelType</h4>
                                            <div class="form-group mb0">
                                                <div class="radio dib mr20">
                                                    <label>
                                                        @Html.RadioButtonFor(m => m.FuelDetails.FuelDisplayGroupId, (int)ProductDisplayGroups.MarineFuelType, new { onclick = "showHideControls(this,'standard-fuels,all-other-fuels,add-favorite','fuels-in-myarea,non-standard-fuels,taxForOtherFuel');radioChange(this,'wrapper-rackprice,wrapper-suppliercost,city-groupterminal,chkcity-groupterminal', null);showPDITaxControls();showPDITaxControls();" })
                                                        @Resource.lblCommon
                                                    </label>
                                                </div>
                                                @if (Model.PreferencesSetting != null && Model.PreferencesSetting.IsAdditiveBlendingEnabled)
                                                {
                                                    <div class="radio dib mr20">
                                                        <label>
                                                            @Html.RadioButtonFor(m => m.FuelDetails.FuelDisplayGroupId, (int)ProductDisplayGroups.AdditiveFuelType, new { onclick = "showHideControls(this,'standard-fuels,all-other-fuels,add-favorite,taxForOtherFuel','fuels-in-myarea,non-standard-fuels,section-tier');radioChange(this,null,'wrapper-rackprice,wrapper-suppliercost,city-groupterminal,chkcity-groupterminal');triggerEvent('.fixed-pricing','click');hideFscControls();hideOtherProductControls(this);" })
                                                            @Resource.lblAdditive
                                                        </label>
                                                    </div>
                                                }
                                                <div class="radio dib">
                                                    <label>
                                                        @Html.RadioButtonFor(m => m.FuelDetails.FuelDisplayGroupId, (int)ProductDisplayGroups.OtherFuelType, new { @class = "otherfueltype", onclick = "showHideControls(this,'non-standard-fuels,add-favorite,taxForOtherFuel','standard-fuels');radioChange(this,null,'wrapper-rackprice,wrapper-suppliercost,city-groupterminal,chkcity-groupterminal');triggerEvent('.fixed-pricing','click');hidePDITaxControls();hideFscControls();hidePDITaxControls();hideOtherProductControls(this);", onchange = "focusOnFirst(this, 'non-standard-fuels');" })
                                                        @Resource.lblOther
                                                    </label>
                                                </div>
                                            </div>
                                        </disv>
                                        <div class="col-sm-12 disable-in-tpo-edit">
                                            <div class="form-group mbo">
                                                <div class="pa bg-white top0 left0 z-index5 loading-wrapper mtm10 loader-fueltype hide-element"><span class="spinner-dashboard pa"></span></div>
                                                <div class="row standard-fuels">
                                                    <div class="col-sm-3 clearboth">
                                                        <div class="row">
                                                            <div class="col-sm-12">
                                                                <div id="fuelTypeNearYourArea" class="fuels-in-myarea hide-element">
                                                                    <div class="pr">
                                                                        <input type="text" class="form-control nearest-fueltype pl16" onkeydown="javascript:return false">
                                                                    </div>
                                                                    <div class="nearest-fuellist pa bg-white">
                                                                        <ul class="list-unstyled"></ul>
                                                                        <div class="text-center">
                                                                            <a href="javascript:void(0)" class="more-nearestfuel">See More</a>
                                                                            <div class="spinner-xsmall mbm2 ml2" style="display:none"></div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="hide-element" id="noFavoriteFuelMsg">
                                                            <div class="alert alert-info mb0 fs13">@Resource.errMessageNoFavFuel</div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="form-group mb0">
                                                                    <div id="allOtherFuelTypes" class="all-other-fuels">
                                                                        @Html.DropDownListFor(m => m.FuelDetails.FuelTypeId, new SelectList(CommonHelperMethods.GetFuelProducts((ProductDisplayGroups)Model.FuelDetails.FuelDisplayGroupId, CurrentUser.CompanyId, Model.FuelDetails.FuelDisplayJobId), "Id", "Name", Model.FuelDetails.FuelTypeId), Resource.lblSelectFuel, new { @class = "form-control" })
                                                                    </div>
                                                                    @Html.ValidationMessageFor(m => m.FuelDetails.FuelTypeId)
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="non-standard-fuels hide-element">
                                                    <div class="row">
                                                        <div class="col-sm-3">
                                                            <div class="form-group">
                                                                @Html.LabelFor(m => m.FuelDetails.NonStandardFuelName)
                                                                @Html.TextBoxFor(m => m.FuelDetails.NonStandardFuelName, new { @class = "form-control" })
                                                                @Html.ValidationMessageFor(m => m.FuelDetails.NonStandardFuelName)
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3 mb15">
                                                            <div class="form-group mb0">
                                                                @Html.LabelFor(m => m.FuelDetails.NonStandardFuelDescription)
                                                                @Html.TextAreaFor(m => m.FuelDetails.NonStandardFuelDescription, new { @class = "form-control" })
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <h4>@Resource.lblQuantity</h4>
                                            <div class="row">
                                                <div class="container ml0">
                                                    @*@Html.HiddenFor(m => m.FuelDetails.FuelQuantity.UoM)*@
                                                    @Html.PartialFor("~/Views/Shared/_PartialFuelQuantity.cshtml", m => m.FuelDetails)
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <h4>@Resource.headingPricing</h4>
                                            <div class="row">
                                                <div class="col-md-12 suppressPricing-section opacity-half">
                                                    <div class="checkbox mt20 mr20">
                                                        <label>
                                                            @Html.CheckBoxFor(m => m.IsSupressOrderPricing, new { disabled = "disabled" }) @Resource.headingSupressPricing
                                                            <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.headingSupressPricing"></i>
                                                            @Html.HiddenFor(m => m.IsSupressOrderPricing)
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="section-pricing">
                                                <div class="">
                                                    @Html.Hidden("hdnRadius", (object)Convert.ToInt32(100))
                                                    @Html.PartialFor("~/Views/Shared/_PartialFuelPricingTPO.cshtml", m => m)
                                                    @Html.HiddenFor(m => m.PricingDetails.CityGroupTerminalId)
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12 surcharge-section">
                                                    <div class="checkbox mt20 mr20">
                                                        <label>
                                                            @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsFuelSurcharge, new { onchange = "showHideonCheckbox(this,'fuel-surcharge-range,fsc-freightcost')" }) @Resource.lblApplyFuelSurchage
                                                            <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.msgFuelSurchargeFreightCost"></i>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-12">
                                                    <div class="row">
                                                        <div class="col-sm-3 surcharge-section">
                                                            <div class="mb15 hide-element fuel-surcharge-range">
                                                                @Html.EnumDropDownListFor(m => m.OrderAdditionalDetailsViewModel.FuelSurchagePricingType, "Select Price", new { @class = "form-control enum-ddl-spt" })
                                                                @Html.ValidationMessageFor(m => m.OrderAdditionalDetailsViewModel.FuelSurchagePricingType)
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-9 fuel-surcharge-range surcharge-section">
                                                            @Html.PartialFor("_PartialFuelSurchargeFreightFee", m => m.FuelDeliveryDetails.FuelFees.FuelSurchargeFreightFee)
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-12 surcharge-section">
                                                    <a onclick="showSurchargeTable();" id="lnkSurchargeTable" class="pntr-none subSectionOpacity">@Resource.lblViewFuelSurchargeTable</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-md-12">
                                    <h4 class="pb10">@Resource.headingOrder</h4>
                                    <div class="row">
                                        <div class="col-sm-4 col-md-3 form-group">
                                            @Html.LabelFor(m => m.AddressDetails.VessleId)<span class="required pl4" aria-required="true">*</span>
                                            @Html.DropDownListFor(m => m.AddressDetails.VessleId, new SelectList(CommonHelperMethods.GetVesselList(Model.CurrentCompanyId).OrderBy(top => top.Name).ToList(), "Id", "Name", Model.AddressDetails.VessleId), Resource.lblSelectVessle, new { @class = "form-control selectvesselId", onchange = "getVesselDetails(this);" })
                                            <span class="field-validation-error hide-element vessel-validation-error" id="spnErrorVessel"></span>
                                        </div>
                                        <div class="col-sm-4 col-md-3 form-group" id="wbsnumber">
                                            @Html.LabelFor(m => m.AddressDetails.IMONumber)<span class="required pl4" aria-required="true"></span>
                                            @Html.TextBoxFor(m => m.AddressDetails.IMONumber, new { @class = "form-control" })
                                            <span class="field-validation-error hide-element IMONumber-validation-error" id="spnErrorIMONumber"></span>
                                        </div>
                                        <div class="col-sm-4 col-md-3 form-group" id="wbsnumber">
                                            @Html.LabelFor(m => m.AddressDetails.Flag)
                                            @Html.TextBoxFor(m => m.AddressDetails.Flag, new { @class = "form-control" })
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-4 col-md-3 form-group">
                                            @Html.LabelFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypeId)
                                            @Html.EnumDropDownListFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes,
                                            new
                                            {
                                            @class = "form-control truckLoadTypes enum-ddl"
                                            })
                                        </div>
                                        <div class="col-sm-4 col-md-3 form-group">
                                            @Html.LabelFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.FreightOnBoardTypes)
                                            @Html.EnumDropDownListFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.FreightOnBoardTypes, new { @class = "form-control freightOnBoardTypes enum-ddl" })
                                        </div>
                                        <div class="col-sm-4 col-md-3 form-group" id="wbsnumber">
                                            @Html.LabelFor(m => m.FuelDeliveryDetails.CustomAttributeViewModel.WBSNumber)
                                            @Html.TextBoxFor(m => m.FuelDeliveryDetails.CustomAttributeViewModel.WBSNumber, new { @class = "form-control" })
                                        </div>
                                        <!-- Is Pro Forma Enabled -->
                                        <div class="col-sm-4 col-md-3 form-group">
                                            <div id="external-ponumber">
                                                @Html.LabelFor(m => m.PONumber)
                                                @Html.TextBoxFor(m => m.PONumber, new { @class = "form-control" })
                                                @Html.ValidationMessageFor(m => m.PONumber)
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-4 col-md-3">
                                            <div>
                                                @Html.LabelFor(m => m.OrderName)
                                                @Html.TextBoxFor(m => m.OrderName, new { @class = "form-control" })
                                                @Html.ValidationMessageFor(m => m.OrderName)
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- fuel request ends -->
                </div>
                <div id="tpo-pricing" class="">
                    <div class="row">
                        <!-- delivery starts -->
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-sm-12">
                                    <h4>@Resource.headingDelivery</h4>
                                    <div class="row">
                                        <div class="col-sm-12 mb5">
                                            <div class="radio dib mr10">
                                                <label>
                                                    @Html.RadioButtonFor(m => m.FuelDeliveryDetails.DeliveryTypeId, (int)DeliveryType.OneTimeDelivery, new { @class = "single-delivery-schedule", onclick = "radioChange(this, 'single-delivery-sub-types','delivery-schedule');showHideControls(this,'single-delivery','multi-delivery,weekend-fee-types');removeRegionValidation();" })
                                                    @Resource.lblSingle
                                                </label>
                                            </div>
                                            <div class="radio dib">
                                                <label>
                                                    @Html.RadioButtonFor(m => m.FuelDeliveryDetails.DeliveryTypeId, (int)DeliveryType.MultipleDeliveries, new { @checked = "checked", @class = "multiple-delivery-schedule", onclick = "radioChange(this, 'delivery-schedule','single-delivery-sub-types,end-date');showHideControls(this,'multi-delivery,weekend-fee-types','single-delivery');removeRegionValidation();" })
                                                    @Resource.lblMultiple
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-3 single-delivery">
                                                    <div class="single-delivery-sub-types">
                                                        @Html.LabelFor(m => m.FuelDeliveryDetails.SingleDeliverySubTypes)
                                                        @Html.EnumDropDownListFor(m => m.FuelDeliveryDetails.SingleDeliverySubTypes, new { @class = "form-control" })
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.FuelDeliveryDetails.StartDate)
                                                        @Html.TextBoxFor(m => m.FuelDeliveryDetails.StartDate, new { @class = "form-control datepicker" })
                                                        @Html.ValidationMessageFor(m => m.FuelDeliveryDetails.StartDate)
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="end-date">
                                                        @Html.Label(Resource.lblEndDate)
                                                        @Html.TextBoxFor(m => m.FuelDeliveryDetails.EndDate, new { @class = "form-control datepicker" })
                                                        @Html.ValidationMessageFor(m => m.FuelDeliveryDetails.EndDate)
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.FuelDeliveryDetails.StartTime)
                                                        @Html.TextBoxFor(m => m.FuelDeliveryDetails.StartTime, new { @class = "form-control timepicker" })
                                                        @Html.ValidationMessageFor(m => m.FuelDeliveryDetails.StartTime)
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.FuelDeliveryDetails.EndTime)
                                                        @Html.TextBoxFor(m => m.FuelDeliveryDetails.EndTime, new { @class = "form-control timepicker" })
                                                        @Html.ValidationMessageFor(m => m.FuelDeliveryDetails.EndTime)
                                                    </div>
                                                </div>
                                                <div class="col-sm-3">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.RegionId)
                                                        <span class="required pl4" aria-required="true" id="MandatoryRegionId">*</span>
                                                        @Html.DropDownListFor(m => m.RegionId, new SelectList(CommonHelperMethods.GetRegionsForTPOOrder(CurrentUser.Id), "Id", "Name", 0), string.Format(Resource.valMessageSelect, Resource.valRegionSelect), new { @class = "form-control", onchange = "addRemoveValidation();" })
                                                        <span class="field-validation-error hide-element RegionId-validation-error" id="spnErrorRegionId"></span>
                                                    </div>
                                                </div>
                                                <div class="col-sm-3" id="subdr-count">
                                                    <div class="form-group">
                                                        @Html.LabelFor(m => m.NumOfSubDrs)
                                                        @Html.TextBoxFor(m => m.NumOfSubDrs, new { @class = "form-control", @type = "number", @min = "0" })
                                                        <span class="field-validation-error hide-element NumOfSubDrs-validation-error" id="spnErrorNumOfSubDrs"></span>
                                                        @*@Html.ValidationMessageFor(m => m.NumOfSubDrs)*@
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12 mb15 multi-delivery">
                                            <div class="row mt5">
                                                <div class="col-md-12">
                                                    <div id="delivery-schedule-section" class="partial-section delivery-schedule defaultDisabled">
                                                        <div class="form-group pl0 mt7">
                                                            <div class="row">
                                                                <div class="col-sm-12">
                                                                    <h3 class="mt0 mb0">@Resource.lblDeliverySchedules</h3>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="partial-block-collection-section">
                                                            @if (Model.FuelDeliveryDetails.DeliverySchedules != null && Model.FuelDeliveryDetails.DeliverySchedules.Count() > 0)
                                                            {
                                                                foreach (var deliverySchedule in Model.FuelDeliveryDetails.DeliverySchedules)
                                                                {
                                                                    Html.RenderPartial("~/Areas/Buyer/Views/Shared/_PartialDeliveryScheduleFR.cshtml", deliverySchedule);
                                                                }
                                                            }
                                                        </div>
                                                        <div class="form-group col-md-12 pl0  delivery-schedule defaultDisabled @((Model.FuelDeliveryDetails.DeliveryTypeId == (int)DeliveryType.OneTimeDelivery) ? " pntr-none" : "" )">
                                                            <a href="javascript:void(0)" class="add-partial-block" data-url="@Url.Action("DeliverySchedule", "FuelRequest" , new { area="Supplier" })"><i class="fas fa-plus-circle"></i> @Resource.btnLabelAddDeliverySchedule</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- delivery ends -->
                    </div>
                </div>
                <div id="tpo-delivery" class="">
                    <div class="row">
                        <!-- job information ends -->
                        <!-- fees starts -->
                        <div class="thirdparty-fees hide-element col-sm-12">
                            <div class="well mb15">
                                @Html.PartialFor("_PartialBrokeredOrderFees", m => m.ExternalBrokeredOrder.BrokeredOrderFee)
                            </div>
                        </div>
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15 fuel-request-fees">
                                <div class="col-sm-12">
                                    <h4 class="freight-cost">@Resource.headingFees</h4>
                                    @Html.PartialFor("_PartialFees", m => m.FuelDeliveryDetails.FuelFees)
                                </div>
                            </div>
                        </div>
                        <!-- fees ends -->
                        <!-- other product taxes starts -->
                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15 taxForOtherFuel hide-element">
                                <div class="col-sm-12">
                                    <h4>@Resource.headingTaxes</h4>
                                    <div class="row">
                                        <div class="container ml0">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="checkbox mt0">
                                                        <label>
                                                            @Html.CheckBoxFor(m => m.IsOtherFuelTypeTaxesGiven, new { onchange = "showHideonCheckbox(this,'addtax')" }) @Resource.lblIsOtherFuelTypeTaxesEnabled
                                                            <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.msgTaxOtherProducts"></i>
                                                        </label>
                                                    </div>
                                                </div>
                                                <div class="col-sm-12 col-md-10 addtax hide-element">
                                                    <div id="otherProductType-tax-section" class="partial-section">
                                                        <div class="partial-block-collection-section">
                                                            @if (Model.TaxDetailsViewModel != null && Model.TaxDetailsViewModel.Count() > 0)
                                                            {
                                                                foreach (var otherProductTax in Model.TaxDetailsViewModel)
                                                                {
                                                                    Html.RenderPartial("_PartialOtherProductTax", otherProductTax);
                                                                }
                                                            }
                                                        </div>
                                                        <div class="form-group col-md-12 pl0 mt7">
                                                            <a href="javascript:void(0)" class="add-partial-block" data-url="@Url.Action("OtherProductTax", "Order" )"><span class="fa fa-plus-circle"></span> @Resource.lblAddTaxes</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- other product taxes ends -->
                        <!-- payment terms starts -->
                        <div id="div-payment-terms" class="col-md-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-sm-12">
                                    <h4>@Resource.lblPaymentDetails</h4>
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <div class="row">
                                                <div class="col-sm-12">
                                                    <div class="form-check form-check-inline radio">
                                                        @Html.RadioButtonFor(m => m.FuelOfferDetails.PaymentTermId, (int)PaymentTerms.NetDays, new { @id = "radio-netpayment", onclick = "radioChange(this,'netdays',null);", onchange = "focusOnFirst(this, 'netdays');", @class = "revalidate form-check-input" })
                                                        <label class="form-check-label" for="radio-netpayment">@Resource.lblNet</label>
                                                    </div>
                                                    <div class="form-check form-check-inline radio">
                                                        @Html.RadioButtonFor(m => m.FuelOfferDetails.PaymentTermId, (int)PaymentTerms.DueOnReceipt, new { @id = "radio-dueonreceipt", onclick = "radioChange(this,null,'netdays')", @class = "revalidate form-check-input" })
                                                        <label class="form-check-label" for="radio-dueonreceipt">@Resource.lblDueOnReceipt</label>
                                                    </div>
                                                    <div class="form-check form-check-inline radio">
                                                        @Html.RadioButtonFor(m => m.FuelOfferDetails.PaymentTermId, (int)PaymentTerms.PrePaidInFull, new { @id = "radio-prepaidfull", onclick = "radioChange(this,null,'netdays')", @class = "revalidate form-check-input" })
                                                        <label class="form-check-label" for="radio-prepaidfull">@Resource.lblPrePaidInFull</label>
                                                    </div>
                                                    <div class="form-check form-check-inline radio">
                                                        @Html.RadioButtonFor(m => m.FuelOfferDetails.PaymentTermId, (int)PaymentTerms.Net30, new { @id = "radio-net30", onclick = "radioChange(this,null,'netdays')", @class = "revalidate form-check-input" })
                                                        <label class="form-check-label" for="radio-net30">@Resource.lblNet30Days</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mt-3">
                                                <div class="col-sm-5">
                                                    <div class="row">
                                                        <div class="col-sm-4 netdays defaultDisabled">
                                                            @Html.TextBoxFor(m => m.FuelOfferDetails.NetDays, new { @class = "form-control always datatype-decimal" })
                                                            @Html.ValidationMessageFor(m => m.FuelOfferDetails.NetDays)
                                                        </div>
                                                        <div class="col-sm-8 pl0 pt8 fs12">
                                                            @Resource.lblDaysOfReceipt
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-4">
                                                    <div class="form-group">
                                                        <label> @Resource.lblPaymentMethod</label>
                                                        @Html.EnumDropDownListFor(m => m.FuelDeliveryDetails.PaymentMethods, new { @class = "form-control" })
                                                    </div>
                                                </div>
                                            </div>
                                                </div>
                                            </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- payment terms ends -->
                </div>
                <div id="tpo-other">
                    <div class="row">
                        <div class="hide-element">
                            <div id="div-invoice-notification-instructions" class="col-sm-12 hide-element">
                                <div class="col-sm-12 well mb15">
                                    <div class="col-sm-12">
                                        <h4 class="pb10">@Resource.lblInvoiceNotificationInstructions</h4>
                                        <div class="row">
                                            @foreach (var pref in Enum.GetValues(typeof(InvoiceNotificationPreferenceTypes)))
                                            {
                                                var type = typeof(InvoiceNotificationPreferenceTypes);
                                                var memberInfo = type.GetMember(pref.ToString());
                                                var attributes = memberInfo[0].GetCustomAttributes(typeof(DisplayAttribute), false);
                                                var displayName = ((DisplayAttribute)attributes[0]).Name;
                                                <div class="col-md-12">
                                                    <div class="radio mb5">
                                                        <label>
                                                            @Html.RadioButtonFor(s => s.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes, (int)pref, Model.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes == (InvoiceNotificationPreferenceTypes)pref ? new { @checked = "checked" } : null)
                                                            @displayName
                                                        </label>
                                                        @if (Model.FuelDetails.IsMarineLocation && (InvoiceNotificationPreferenceTypes)pref == InvoiceNotificationPreferenceTypes.SendPDIDeliveryDetails)
                                                        {
                                                            <div class="ml25 checkbox">
                                                                @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsIncludePricing, new { @class = "no-hidden-click" })
                                                                <label class="" for="IsIncludePricing">@Resource.lblIncludePricing</label>
                                                            </div>
                                                        }
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-12">
                            <div class="col-sm-12 well mb15">
                                <div class="col-sm-12">
                                    <h4 class="pb10">Other Details</h4>
                                    <div class="row">
                                        <div class="col-sm-3 mb10 hide-element">
                                            <label>@Resource.lblCarrier</label>
                                            @Html.PartialFor("~/Views/Shared/_PartialCarrier.cshtml", m => m.Carrier)
                                        </div>
                                        <div class="hide-element">
                                            <div class="col-sm-3 mb10 hide-element">
                                                @Html.LabelFor(m => m.OrderAdditionalDetailsViewModel.SupplierSource.Name)
                                                @Html.PartialFor("~/Views/Shared/_PartialSupplierSource.cshtml", m => m.OrderAdditionalDetailsViewModel.SupplierSource)
                                            </div>
                                        </div>
                                        <div class="col-sm-3 mb10 hide-element">
                                            @Html.LabelFor(m => m.OrderAdditionalDetailsViewModel.SupplierSource.ContractNumber)
                                            @Html.TextBoxFor(m => m.OrderAdditionalDetailsViewModel.SupplierSource.ContractNumber, new { @class = "form-control", @placeholder = @Resource.lblContractNumber })
                                        </div>
                                        @*@if (Model.PreferencesSetting == null || (Model.PreferencesSetting != null && !Model.PreferencesSetting.IsSupressOrderPricing))
                                            {*@
                                        <div class="hide-element">
                                            <div class="col-sm-3 mb10 supplier-allowence hide-element">
                                                <label>@Resource.lblSupplierAllowance</label>
                                                <div class="input-group mtm1">
                                                    <span class="input-group-addon currency-symbol allowance">@Model.AddressDetails.Country.Currency/@Resource.lblPerGallon</span>
                                                    @Html.TextBoxFor(m => m.OrderAdditionalDetailsViewModel.Allowance, new { @class = "form-control datatype-decimal always" })
                                                </div>
                                                @Html.ValidationMessageFor(m => m.OrderAdditionalDetailsViewModel.Allowance)
                                            </div>
                                        </div>

                                        @*}*@
                                        @*<div class="hide-element">
                                                <div class="col-sm-4 order-close-threshold mb10 hide-element">
                                                @Html.LabelFor(m => m.FuelOfferDetails.CloseOrderId)
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <div class="input-group">
                                                                @Html.TextBoxFor(m => m.FuelOfferDetails.OrderClosingThreshold, new { @class = "form-control" })
                                                                <span class="input-group-addon">%</span>
                                                            </div>
                                                            @Html.ValidationMessageFor(m => m.FuelOfferDetails.OrderClosingThreshold)
                                                        </div>
                                                    </div>
                                                    <div class="col-sm-4 pt8 pl10">
                                                        @Resource.lblComplete
                                                    </div>
                                                </div>
                                            </div>*@
                                        @*</div>*@

                                        <div class="col-md-6 mb10">
                                            <label>@Resource.lblDrNotes</label>
                                            <div class="mtm1">
                                                @Html.TextAreaFor(m => m.OrderAdditionalDetailsViewModel.DRNotes, new { @class = "form-control" })
                                                @Html.ValidationMessageFor(m => m.OrderAdditionalDetailsViewModel.DRNotes)
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                @*<div class="col-sm-12">
                                    <div class="row mb10">
                                        <div class="col-md-6">
                                            <div id="special-instruction-section" class="partial-section mirror">
                                                <div class="partial-block-collection-section">
                                                    @if (Model.FuelDeliveryDetails.SpecialInstructions != null && Model.FuelDeliveryDetails.SpecialInstructions.Count() > 0)
                                                    {
                                                        foreach (var instruction in Model.FuelDeliveryDetails.SpecialInstructions)
                                                        {
                                                            Html.RenderPartial("~/Views/Shared/_PartialSpecialInstruction.cshtml", instruction);
                                                        }
                                                    }
                                                </div>
                                                <a href="javascript:void(0)" class="add-partial-block" data-url="@Url.Action("SpecialInstruction", "FuelRequest" , new { area="Supplier" })"><span class="fa fa-plus-circle"></span> @Resource.lblSpecialInstruction</a>
                                                <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.infoMessageSpecialInstructions"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@
                                <div class="col-sm-12 hide-element">
                                    <div class="row mb10 mt30">
                                        <div class="col-md-12">
                                            <h4>@Resource.headingBadgeDetails</h4>
                                            @Html.PartialFor("_PartialOrderBadge", m => m.OrderBadgeDetails)
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-12 hide-element">
                            <div class="col-sm-12 well mb15 address-container" id="billing-address">
                                <div class="col-sm-12">
                                    <div class="billing-control">
                                        <div class="checkbox mt0 mb0 dib">
                                            <div class="form-group mb0">
                                                <div id="lbl-chk-billing-address">
                                                    <div id="chk-billing-address" class="dib">
                                                        @Html.CheckBoxFor(m => m.BillingAddress.IsBillingAddressRequired, new { @onchange = "toggleBillingAddressControls(this)", @class = "mt15" })
                                                    </div>
                                                    <h4 class="dib">@Resource.lblBillingAddress</h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="pull-right dib mt10">
                                            <a href="javascript:void(0);" class="color-grey fs18 ml5 toggle-tiledata" onclick="toggleTileElement(this, 'billing-address');"><i class="fa fa-chevron-circle-up"></i></a>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-12 billing-address-controls element-container">
                                    <div class="row combineDiv">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                @Html.LabelFor(m => m.BillingAddress.Address)
                                                @Html.TextBoxFor(m => m.BillingAddress.Address, new { @class = "form-control address addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-address-validation-error" id="spnErrorBillingAddress"></span>
                                            </div>
                                        </div>
                                        <div class="col-xs-3">
                                            <div class="form-group">
                                                @Html.LabelFor(m => m.BillingAddress.ZipCode)
                                                @Html.TextBoxFor(m => m.BillingAddress.ZipCode, new { @class = "form-control billingZipCode addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-zipcode-validation-error" id="spnErrorBillingZipCode"></span>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                @Html.LabelFor(m => m.BillingAddress.City)
                                                @Html.TextBoxFor(m => m.BillingAddress.City, new { @class = "form-control city addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-city-validation-error" id="spnErrorBillingCity"></span>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                @Html.LabelFor(m => m.BillingAddress.County)
                                                @Html.TextBoxFor(m => m.BillingAddress.County, new { @class = "form-control county addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-county-validation-error" id="spnErrorBillingCounty"></span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row combineDiv">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                @Html.LabelFor(m => m.BillingAddress.CountryName)
                                                @Html.TextBoxFor(m => m.BillingAddress.CountryName, new { @class = "form-control country addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-country-validation-error" id="spnErrorBillingCountry"></span>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                @*@Html.HiddenFor(m => m.BillingAddress.StateName, new { @Value = Resource.lblDummy })*@
                                                @Html.LabelFor(m => m.BillingAddress.StateName)
                                                @Html.TextBoxFor(m => m.BillingAddress.StateName, new { @class = "form-control state addressInput address-type" })
                                                <span class="field-validation-error hide-element billing-state-validation-error" id="spnErrorBillingState"></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="floating-buttons white-bg pt10">
            <div class="container">
                <div class="row">
                    <div class="col-sm-9 text-right">
                        <input type="button" value="Cancel" class="btn" onclick="GoToPreviousURL()" />
                        @*<input name="preview" type="button" value="Prev" class="btn btn-lg btn-default btnPrev" onclick="changeTab(this, 'prev');onTabChanged();" />
                            <input name="next" type="button" value="Next" class="btn btn-lg btn-default btnNext" onclick="changeTab(this, 'next'); onTabChanged();" />*@
                        <input id="@Resource.btnLabelSubmit" type="button" value="@Resource.btnLabelSubmit" class="btn btn-lg btn-primary btnSubmit" />
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-3">
            <div id="inventory-data-capture-type" class="well hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3>@Resource.lblInventoryCaptureMethod</h3>
                        <div class="form-group mb0">
                            <div class="radio mb5">
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.InventoryDataCaptureType, InventoryDataCaptureType.NotSpecified, new { @checked = "checkded" })
                                        @InventoryDataCaptureType.NotSpecified.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.InventoryDataCaptureType, InventoryDataCaptureType.Connected)
                                        @InventoryDataCaptureType.Connected.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.InventoryDataCaptureType, InventoryDataCaptureType.Manual)
                                        @InventoryDataCaptureType.Manual.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.InventoryDataCaptureType, InventoryDataCaptureType.CallIn)
                                        @InventoryDataCaptureType.CallIn.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.InventoryDataCaptureType, InventoryDataCaptureType.Mixed)
                                        @InventoryDataCaptureType.Mixed.GetDisplayName()
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Resource.headingCustomer</h3>
                        <div class="custom-control custom-checkbox">
                            @Html.CheckBoxFor(m => m.IsNotifyDeliveries, new { @class = "custom-control-input" })
                            <label class="custom-control-label" for="IsNotifyDeliveries">@Resource.lblNotifyDeliveries</label>
                        </div>
                        <div class="custom-control custom-checkbox">
                            @Html.CheckBoxFor(m => m.IsNotifySchedules, new { @class = "custom-control-input" })
                            <label class="custom-control-label" for="IsNotifySchedules">@Resource.lblNotifySchedules</label>
                        </div>
                        <div class="custom-control custom-checkbox">
                            @Html.CheckBoxFor(m => m.IsInvitationEnabled, new { @class = "custom-control-input" })
                            <label class="custom-control-label" for="IsInvitationEnabled">@Resource.lblSendInvitationLink</label>
                        </div>
                        <div class="custom-control custom-checkbox">
                            @Html.CheckBoxFor(m => m.AddressDetails.IsProFormaPoEnabled, new { onclick = "togglePoFromaPoElement(this);", @class = "custom-control-input" })
                            <label class="custom-control-label" for="AddressDetails_IsProFormaPoEnabled">@Resource.lblProFormaPOEnabled (@Resource.lblOptional)</label>
                        </div>
                        <div class="custom-control custom-checkbox mb0 address-controls">
                            @Html.CheckBoxFor(m => m.AddressDetails.IsRetailJob, new { onChange = "onJobTypeChange(this)", @class = "custom-control-input" })
                            <label class="custom-control-label" for="AddressDetails_IsRetailJob">@Resource.lblRetailJob</label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Resource.headingAsset</h3>
                        <div class="checkbox">
                            <label class="enableAssetTracking">
                                @Html.CheckBoxFor(m => m.IsAssetTracked, new { onclick = "checkBoxChange(this,'enableStatusForAllAssets')", @class = "no-hidden-click" }) @Resource.lblEnableAssetTracking
                            </label>
                        </div>
                        <div class="checkbox enableStatusForAllAssets subSectionOpacity pntr-none mb0">
                            <label>
                                @Html.CheckBoxFor(m => m.IsAssetDropStatusEnabled) @Resource.lblEnableStatusForAllAssets
                                <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.lblMessageDropStatusForAllAssets"></i>
                            </label>
                            <label>
                                @Html.CheckBoxFor(m => m.FuelDeliveryDetails.IsPrePostDipRequired)
                                @Resource.lblRequiredPrePostDipTestDataForEachTankAsset
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Resource.lblInvoiceCreationPreference</h3>
                        <label class="mb5 mt0 hide-from-tpo f-bold">@Resource.lblInvoiceCreationPreference</label>
                        <div class="form-group mb0">
                            <div class="radio mb5">
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.FuelDeliveryDetails.OrderEnforcementId, OrderEnforcement.EnforceOrderLevelValues, new { @checked = "checkded" })
                                        @Resource.lblEnforceOrderLevelValues
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.FuelDeliveryDetails.OrderEnforcementId, OrderEnforcement.ManageException)
                                        @Resource.lblManageExceptions
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.FuelDeliveryDetails.OrderEnforcementId, OrderEnforcement.NoEnforcement)
                                        @Resource.lblNoEnforcement
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="location-managed" class="well hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Html.LabelFor(m => m.AddressDetails.LocationManagedType)</h3>
                        <div class="form-group mb0">
                            <div class="radio mb5">
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.LocationManagedType, LocationManagedType.NotSpecified, new { @checked = "checked", onclick = "showHideControls(this,'noelement','carrier-section');hideShowRouteDdl(false)" })
                                        @LocationManagedType.NotSpecified.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.LocationManagedType, LocationManagedType.SupplierManaged, new { onclick = "showHideControls(this,'noelement','carrier-section');hideShowRouteDdl(false)" })
                                        @LocationManagedType.SupplierManaged.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.LocationManagedType, LocationManagedType.PartialCarrierManaged, new { onclick = "showHideControls(this,'noelement','carrier-section');hideShowRouteDdl(false)" })
                                        @LocationManagedType.PartialCarrierManaged.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db">
                                    <label>
                                        @Html.RadioButtonFor(m => m.AddressDetails.LocationManagedType, LocationManagedType.FullyCarrierManaged, new { onclick = "showHideControls(this,'carrier-section','noelement');hideShowRouteDdl(true)" })
                                        @LocationManagedType.FullyCarrierManaged.GetDisplayName()
                                        <i class="fa fa-info-circle ml5" data-toggle="tooltip" data-placement="top" title="@Resource.lblAssignDRToCarrierText"></i>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well divTrailerType address-controls hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0 mb5">@Resource.lblTrailerCompatibility</h3>
                        @Html.ListBoxFor(m => m.TrailerType, new SelectList(CommonHelperMethods.GetTrailerTypeEnumList(), "Text", "Value", 0), new { @class = "form-control multi-select", @style = "padding-left:0px" })
                    </div>
                </div>
            </div>
            <div id="freight-pricing-method" class="well hide-element">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Html.LabelFor(m => m.OrderAdditionalDetailsViewModel.FreightPricingMethod)</h3>
                        <div class="form-group mb0">
                            <div class="radio mb5">
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.OrderAdditionalDetailsViewModel.FreightPricingMethod, FreightPricingMethod.Manual, new { @checked = "checked" })
                                        @FreightPricingMethod.Manual.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.OrderAdditionalDetailsViewModel.FreightPricingMethod, FreightPricingMethod.Auto)
                                        @FreightPricingMethod.Auto.GetDisplayName()
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="destined-for-international-waters" class="well">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Html.LabelFor(m => m.OrderAdditionalDetailsViewModel.DestinedForInternationalWaters)</h3>
                        <div class="form-group mb0">
                            <div class="radio mb5">
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.OrderAdditionalDetailsViewModel.DestinedForInternationalWaters, DestinedForInternationalWaters.Yes, new { @checked = "checked" })
                                        @DestinedForInternationalWaters.Yes.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.OrderAdditionalDetailsViewModel.DestinedForInternationalWaters, DestinedForInternationalWaters.No)
                                        @DestinedForInternationalWaters.No.GetDisplayName()
                                    </label>
                                </div>
                                <div class="db mr20">
                                    <label>
                                        @Html.RadioButtonFor(m => m.OrderAdditionalDetailsViewModel.DestinedForInternationalWaters, DestinedForInternationalWaters.Unknown)
                                        @DestinedForInternationalWaters.Unknown.GetDisplayName()
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="well">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="mt0">@Resource.lblDriver should</h3>
                        <div class="checkbox">
                            <label>
                                @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsDriverToUpdateBOL, new { @class = "no-hidden-click" })
                                @Resource.lblDriverToUpdateBOL

                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                @Html.CheckBoxFor(m => m.FuelDeliveryDetails.IsBolImageRequired, new { @class = "no-hidden-click" })
                                @Resource.lblBOLImageRquired

                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                @Html.CheckBoxFor(m => m.FuelDeliveryDetails.IsDropImageRequired, new { @class = "no-hidden-click" })
                                @Resource.lblDropImageRquired
                            </label>
                        </div>
                        <div class="checkbox mb0">
                            <label>
                                @Html.CheckBoxFor(m => m.AddressDetails.SignatureEnabled)
                                @Resource.lblEnableSignature
                            </label>
                        </div>
                        <div class="checkbox mb0">
                            <label>
                                @Html.CheckBoxFor(m => m.IsBadgeMandatory)
                                @Resource.lblIsBadgeNumberMandatory
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div id="bdn-invoice confirmation-flags" class="well">
                <div class="row">
                    <div class="col-sm-12">
                        @*<h3 class="mt0"> headers should come here</h3>*@
                        <div class="form-check">
                            @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsManualBDNConfirmationRequired, new { @class = "form-check-input" })
                            <label class="form-check-label" for="bdn-confirmation">
                                @Resource.lblRequiredBDNConfirmation
                            </label>
                        </div>
                        <div class="form-check">
                            @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsManualInvoiceConfirmationRequired, new { @class = "form-check-input" })
                            <label class="form-check-label" for="invoice-confirmation">
                                @Resource.lblRequiredInvoiceConfirmation
                            </label>
                        </div>
                        <div class="form-check pdieTax-confirmation">
                            @Html.CheckBoxFor(m => m.OrderAdditionalDetailsViewModel.IsPdiTaxRequired, new { @class = "form-check-input" })
                            <label class="form-check-label" for="pdieTax-confirmation">
                                @Resource.lblPdieTaxRequired
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="enable-tpo-buyer">
                @Html.Partial("~/Views/Shared/_PartialJobSpecificBillToView.cshtml")
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade float-left" id="jobSpecificBillToModel" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body" id="jobSpecificBillToData">
                    @Html.PartialFor("_PartialJobSpecificBillingAddress", m => m.BillToInfo)
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade float-left" id="billingAddressConfirmation" role="dialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">

                    <div class="col-sm-12">
                        You haven't provided a Billing Address. Would you like to add one before proceeding?
                    </div>
                    <div class="col-sm-12 text-center">
                        <input type="button" value="Yes" class="btn btn-lg btn-primary" data-dismiss="modal">
                        <input type="button" value="No" class="btn btn-lg btn-default" onclick="submitFromBiilingPrompt()">
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="side-panel" id="set-tier-price">
        <div class="side-panel-wrapper">
            <div class="pa bg-white top0 left0 z-index5 loading-wrapper pricinglider-loader hide-element"><span class='spinner-dashboard pa'></span></div>
            <div class="pt10 pb0">
                <a class="ml20 close-panel" onclick="closeSlidePanel();"><i class="fa fa-close fs18"></i></a>
                <h3 class="dib mt0 mb0 ml15">Set Tier Price </h3>
            </div>
            <div id="tier-pricing-slider">
            </div>
        </div>
    </div>
}
@using (Html.BeginScripts())
{
    <script src="https://maps.googleapis.com/maps/api/js?key=@(SiteFuel.Exchange.Core.Utilities.AppSettings.GoogleMapApiKey)" type="text/javascript"></script>
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Content/js/address-goecoder")
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Content/js/quantityrange-validate")
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Script/Main/Order")
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Script/Main/Job")
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Content/js/pricing")

<script type="text/javascript">
        $.validator.setDefaults({ ignore: "" });
        var latLongFuelTypeChanged = true, isExistingJob = false;
		var mapsApiKey = '@SiteFuel.Exchange.Core.Utilities.AppSettings.GoogleApiKey';
        var productListUrl = "@Url.Action("GetProductList", "FuelRequest", new { area = "Supplier" })";
        var allStates =  @Html.Raw(Json.Encode(CommonHelperMethods.GetStatesOfAllCountries()));
        var stateId = @Model.AddressDetails.State.Id; // for state autofill
        var zipCode = getZipcode();
        var jobId = getJobIdFromDropdown();
		var isCustomBillingAddressAllowed = true;
		var fuelSurchargeLink = "@Url.Action("BuyerDetails", "Dashboard", new { area = "Supplier" })";
		var getProductTypeUrl = '@Url.Action("GetMstProducts", "FuelRequest", "Supplier")';
		var customerCompany = '';

        function hideShowRouteDdl(value) {
            value ? ($("#routediv").addClass('hide'), $(".routecontrol").val(null)) : $("#routediv").removeClass('hide');
        }
        function AddRemoteValidation() {
            $("#@Html.IdFor(m => m.AddressDetails.JobName)").rules("add", {
                remote: {
                    url: "@Url.Action("ValidateJobName", "Order", new { area = "Supplier" })",
                    type: "post",
                    data: {
                        jobName: function () { return $("#@Html.IdFor(m => m.AddressDetails.JobName)").val(); },
                        companyName: function () { return $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val(); }
                    }
                },
                messages: {
                    remote: '@Resource.errMessageJobNameAlreadyExists'
                }
            });
        }

        function isExistingJobRadioSelected(isExisting) {
            toggleAddressConstrols(isExisting);
            toggleSalesTaxExemption(isExisting);
            if ($("input:radio[name='AddressDetails.IsNewJob'][value='False']").is(":checked") == true) {
                $("#@Html.IdFor(m => m.AddressDetails.JobName)").rules("remove", "remote");
            }
            else {
                AddRemoteValidation();
            }
            toggleSiteImageUpload();
        }

        function AddNewDriver() {
         $("#@Html.IdFor(m => m.IsNewDriver)").val('True');
            $("#@Html.IdFor(m => m.DriverId)").attr("disabled", "disabled");
            $(".new-driver").slideDown();
            $(".new-driver :input").removeAttr("disabled");
            $("#link-addnewdriver").hide();
            $("#@Html.IdFor(m => m.DriverId)").val('');
            $("#@Html.IdFor(m => m.DriverFirstName)").focus();
        }

        function RevertDriver() {
            $("#@Html.IdFor(m => m.IsNewDriver)").val('False');
            $("#@Html.IdFor(m => m.DriverId)").removeAttr("disabled");
            $(".new-driver").slideUp();
            $("#link-addnewdriver").show();
            $(".new-driver :input").attr("disabled", "disabled");
        }

        function toggleAddressConstrols(isExisting) {
            if (isExisting) {
                $(".address-controls").removeClass("subSectionOpacity");
                $(".company-owned").removeClass("pntr-none");
				$('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').attr('readonly', 'readonly');
            }
            else {
                $(".address-controls").addClass("subSectionOpacity");
                $(".company-owned").addClass("pntr-none");
                $('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').removeAttr('readonly');
            }
        }

         function toggleSiteImageUpload() {
            if (!isNewJobRadioChecked())
            {
                 $("#image-tpo").hide();
            }
            else {
                 $("#image-tpo").show();
            }
        }

        var billingAddressId = 0;
        function ClearBillingAddress(customBillingAddressAllowed) {
            isCustomBillingAddressAllowed = customBillingAddressAllowed;
            if (!customBillingAddressAllowed && billingAddressId > 0) {
                $('#BillingAddress_IsBillingAddressRequired').removeAttr('readonly');
                $('#BillingAddress_IsBillingAddressRequired').prop('checked', true);
                $('#chk-billing-address').show();
                $('#lbl-chk-billing-address').addClass('pl0');
                $(".billing-address-controls").removeClass("subSectionOpacity");
                $(".billing-address-controls :input").removeAttr('readonly').removeClass("pntr-none");
                enableElement('.billing-address-controls');
                isCustomBillingAddressAllowed = true;
                $("#BillingAddress_Country").trigger('change');
            }
            else {
                $('.billing-address-controls :input.address').val("");
                $('.billing-address-controls :input.city').val("");
                $('.billing-address-controls :input.zipcode').val("");
                $('.billing-address-controls :input.state').val("");
                $('.billing-address-controls :input.country').val("");
                billingAddressId = 0;
                $('#BillingAddress_IsBillingAddressRequired').removeAttr('readonly');
                $('#chk-billing-address').show();
                $('#lbl-chk-billing-address').removeClass('pl0');
                if ($('#AddressDetails_IsVarious').is(":checked") &&
                    customBillingAddressAllowed) {
                    CheckAddBillingAddress(true);
                }
                else {
                    $('#BillingAddress_IsBillingAddressRequired').prop('checked', false);
                }
            }
        }

        function toggleBillingAddressControls(elem) {
            if (isCustomBillingAddressAllowed) {
				if ($(elem).is(':checked')) {
					enableElement('.billing-address-controls');
                    $(".billing-address-controls").removeClass("subSectionOpacity");
                    $(".billing-address-controls").find('.combineDiv').removeClass("subSectionOpacity");
                    $(".billing-address-controls :input").removeAttr('readonly').removeClass("pntr-none");
                    if (isTileCollapsed('billing-address')) {
                        toggleTileElement(null, 'billing-address');
                    }
				}
                else {
                    if ($('#AddressDetails_IsVarious').is(':checked') &&
                        $("#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)").val() == 'True') {
                        $('#BillingAddress_IsBillingAddressRequired').prop('checked', true);
                    }
                    else {
                        disableElement('.billing-address-controls');
                        $(".billing-address-controls").addClass("subSectionOpacity");
                        $(".billing-address-controls :input").attr('readonly', 'readonly').addClass("pntr-none");
                    }
				}
			}
			else {
				$('#BillingAddress_IsBillingAddressRequired').prop('checked', false);
			}
		}

        function togglePoFromaPoElement(element) {
            if ($(element).is(':checked')) {
                $("#external-ponumber").hide();
            }
            else {
                $("#external-ponumber").show();
            }
        }

        function toggleSalesTaxExemption(isExisting) {
            if (isExisting) {
                $("#@Html.IdFor(m => m.IsTaxExempted)").attr("disabled", "disabled");
                $("#sales-tax-exempt").addClass("subSectionOpacity");
            }
            else {
                $("#@Html.IdFor(m => m.IsTaxExempted)").removeAttr("disabled", "disabled");
                $("#sales-tax-exempt").removeClass("subSectionOpacity");
            }
        }

        function enableVarious() {
            $('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').parent().show();

        }

        function disableVarious() {

            $('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').parent().hide();
            $('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').prop('checked', false);
            CheckAddBillingAddress(false);
            showHideControls(this,'wrapper-location','wrapper-various');
        }

        $('#AddressDetails_IsVarious').click(function ()
        {
            if (!$('#AddressDetails_IsVarious').is(":checked")) {
                showHideControls(this, 'wrapper-location', 'wrapper-various');
                CheckAddBillingAddress(false);
            }
            else
            {
               CheckAddBillingAddress(true);
               // $('#BillingAddress_IsBillingAddressRequired').prop('checked', true);
               CheckAddBillingAddress(true);
               showHideControls(this, 'wrapper-various', 'wrapper-location');
               $('input:checkbox[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').val('true');
              //  $(".wrapper-various").prop("disabled", "disabled");
               // $("#address-controls").removeClass("subSectionOpacity");
            }

        });

        $('#IsAssetTracked').click(function () {
            if (!$('#IsAssetTracked').is(":checked")) {
                $('#FuelDeliveryDetails_IsPrePostDipRequired').prop('checked', false);
                $('#IsAssetDropStatusEnabled').prop('checked', false);
            }
        });

        function onTabChanged() {
            if ($('#AddressDetails_IsVarious').is(":checked")) {
                CheckAddBillingAddress(true);
                $('#BillingAddress_IsBillingAddressRequired').trigger('click');
            }
        }

        function selectAxxis() {
            $('.ddl-pricing-source').val(@((int)PricingSource.Axxis));
            $('.ddl-pricing-source').trigger('change');
        }

        function updateJobSpecificHeaders(oldString, newString) {
            $(".job-section .job-site-info").each(function () {
                var text = $(this).text();
                text = text.replace(oldString, newString);
                $(this).text(text);
            });
        }

        function isFTLSelected() {
            return $('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').val() == '@((int)TruckLoadTypes.FullTruckLoad)';
        }

        function UpdateDeliveryScheduleCarriers() {
                $('.tpo-carrier').show();
        }

        function submitFromBiilingPrompt() {
            $('#Submit').attr('disabled', 'disabled');
            $('#Submit').addClass("subSectionOpacity");
            $(".loader").show();
            let $form = $("#createOrderForm");
            $form.submit();
        }

    $(document).ready(function () {
        $(".selectCompany").select2({
                      ajax: {
                        url: "@Url.Action("GetAllBuyerCompanyList", "Order", new { area = "Supplier" })",
                        dataType: 'json',
                        delay: 1000,
                        data: function (params) {
                          return {
                            companyName: params.term, // search term
                            page: params.page
                          };
                        },
                    processResults: function (data, params) {
                        params.page = params.page || 1;
                        return {
                            results: $.map(data, function (val, item) {
                                return { id: val.Id, text: val.Name };
                            }),
                            // if more then 30 items in dropdown, remaining set of items  will be show on numbered page link in dropdown control.
                            pagination: { more: (params.page * 30) < data.length }
                        };
                    }
                },
                minimumInputLength: 1 // Minimum length of input in search box before ajax call triggers
        });
        if (@Model.CustomerDetails.CompanyId.HasValue) {
                $(".selectCompany").append(new Option('@Model.CustomerDetails.CompanyName', '@Model.CustomerDetails.CompanyId', true, true)).trigger('change');
        };
        $('.opacity-half').css("opacity","0.5");

        $(".selectExistingJobId").select2({
            placeholder: '@string.Format(Resource.valMessageSelect, Resource.lblPort)',
            allowClear: true
        }).on('select2:opening', function (e) {
            $(this).data('select2').$dropdown.find(':input.select2-search__field').attr('placeholder', '@Resource.lblPort')
        });
        $(".selectvesselId").select2({
            placeholder: '@string.Format(Resource.valMessageSelect, Resource.lblVessle)',
            allowClear: true
        }).on('select2:opening', function (e) {
            $(this).data('select2').$dropdown.find(':input.select2-search__field').attr('placeholder', '@Resource.lblVessle')
        });
        // set existing location as default for PBI #28470
        $("#radio-existingjob").click();
        if ('@Model.IsCloneOrder' == 'False') {
            $(".single-delivery-schedule").click();
            $("#radio-quantityfixed").click();
        }
        else {
            var deliveryTypeId = '@(Model.FuelDeliveryDetails.DeliveryTypeId)';
            if (deliveryTypeId == '@((int)DeliveryType.OneTimeDelivery)') {
                $(".single-delivery-schedule").click();
            }
        }

        $("#radio-existingcustomer").click();
        $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").focus();

        $('input:radio[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes)"][value=' + @((int)InvoiceNotificationPreferenceTypes.SendPDIDeliveryDetails) + ']').prop('checked', true).trigger('change');
        $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualBDNConfirmationRequired)").trigger('change');
            @*var isSupressOrderLevelPricingEnabled = '@(Model.PreferencesSetting != null ? Model.PreferencesSetting.IsSupressOrderPricing: false)';*@
        var isSupressOrderLevelPricingEnabled = $('#IsSupressOrderPricing').prop('checked');
        if (!isSupressOrderLevelPricingEnabled)
            $('input[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.IsIncludePricing)"]').prop('checked', true);

        var defaultUoM = parseInt($('#MFNQuantityUoM').val());
        $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val(defaultUoM);
        $("#@Html.IdFor(m => m.AddressDetails.Country.UoM)").val(defaultUoM);

        $(".enum-ddl-spt option[value='0']").remove();
        checkBoxChange(".enableAssetTracking input:checkbox", "enableStatusForAllAssets");
        UpdateCurrencyAndUom($("#@Html.IdFor(m => m.AddressDetails.Country.Currency)"));
        toggleTileElement(null, 'billing-address');
        $('.ddl-schedule-qty-type').removeClass('hide-element');

        if ($("#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)").val() == 'True') {
            $(".uom-section").addClass("hide-element");
            //$(".mfn-uom-section").removeClass("hide-element");
            if ($("#@Html.IdFor(m => m.AddressDetails.Country.Currency)").val() == '@((int)Currency.USD)') {
                //$('#@Html.IdFor(M => M.AddressDetails.MarineUoM)').children('option[value="@((int)UoM.Litres)"]').hide();
                //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Gallons)"]').show();
                $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Gallons)");

                //UOM in qty section
                $("#MFNQuantityUoM").trigger("change");

            }
            if ($("#@Html.IdFor(m => m.AddressDetails.Country.Currency)").val() == '@((int)Currency.CAD)') {
                //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Litres)"]').show();
                //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Gallons)"]').hide();
                $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Litres)");
                //UOM in qty section
                $("#MFNQuantityUoM").trigger("change");
            }

        }
        else {
            $(".uom-section").removeClass("hide-element");
            //$(".mfn-uom-section").addClass("hide-element");
        }

        $(document).on('change', $('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]'), function () {
            CloseOrderWhen();
            if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() != '@((int)QuantityType.NotSpecified)' && $('#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)').val() == 'True') {
                //$('.marine-quantity-uom').show();
                $('.quantity-uom').addClass('hide-element');
                if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.OneTimeDelivery)' && $('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val() == '@((int)Country.USA)'
                        && $('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() == '@((int)QuantityType.SpecificAmount)') {
                    $('#subdr-count').show();
                }
                else {
                    $('#subdr-count').hide();
                }
            }
            else {
                //$('.marine-quantity-uom').hide();
                $('.quantity-uom').removeClass('hide-element');
                $('#subdr-count').hide();
            }
        });

        //to load order details for clone order
        if ('@Model.IsCloneOrder' == 'True') {
            $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").trigger('change');
            $(".suppressPricing-section").removeClass('pntr-none subSectionOpacity');
        }

        $("#terminalContainer").removeClass('hidden');
        $('.show-in-tpo').css('display', 'inline-block');
        var addressStateId = $('#@Html.IdFor(m => m.AddressDetails.State.Id)').val();
        if (addressStateId > 0) {
            var cityGrpTerminalId = @(Model.FuelDetails.FuelPricing.CityGroupTerminalId ?? 0);
            fillCityGroupTerminals(addressStateId, cityGrpTerminalId);
        }
        CloseOrderWhen();
        var $form = $("#createOrderForm");
        AddRemoteValidation();

        $('input[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"]').click(function () {
            var selectedPricingType = parseInt($('input[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"]:checked').val());
            if (selectedPricingType != '@((int)PricingType.Suppliercost)') {
                validationMessageFor($("#@Html.IdFor(m => m.PricingDetails.PricingTypeId)").attr('name'), '');
            }
        });

        $(document).on('change', '#@Html.IdFor(m => m.FuelDeliveryDetails.SingleDeliverySubTypes)', function () {
            ToggleEndDate();
        });

        $(document).on('change', '#@Html.IdFor(m => m.FuelDeliveryDetails.DeliveryTypeId)', function () {
            CloseOrderWhen();
            ToggleEndDate();
            if ($(this).val() == '@((int)DeliveryType.OneTimeDelivery)') {
                $("input[name='@Html.NameFor(m => m.FuelDetails.TierPricing.TierPricingType)'][value=" + @((int)TierPricingType.VolumeBased) + "]").addClass('subSectionOpacity pntr-none');
                $("input[name='@Html.NameFor(m => m.FuelDetails.TierPricing.TierPricingType)'][value=" + @((int)TierPricingType.DeliveryQuantityBased) + "]").trigger('click');
            }
            else {
                $("input[name='@Html.NameFor(m => m.FuelDetails.TierPricing.TierPricingType)'][value=" + @((int)TierPricingType.VolumeBased) + "]").removeClass('subSectionOpacity pntr-none');
            }
        });

        if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.OneTimeDelivery)') {
            $("input[name='@Html.NameFor(m => m.FuelDetails.TierPricing.TierPricingType)'][value=" + @((int)TierPricingType.VolumeBased) + "]").addClass('subSectionOpacity pntr-none');
            $("input[name='@Html.NameFor(m => m.FuelDetails.TierPricing.TierPricingType)'][value=" + @((int)TierPricingType.DeliveryQuantityBased) + "]").trigger('click');
        }

        $(document).on('dp.change', '#@Html.IdFor(m => m.FuelDeliveryDetails.StartDate)', function () {
            var quoteStartDate = $(this).val();
            $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').data("DateTimePicker").useCurrent(false);
            $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').data("DateTimePicker").minDate(moment(quoteStartDate).startOf('d'));
        });
        $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').data("DateTimePicker").minDate(moment().startOf('d'));

        $(document).on('click', '#Submit', function (e) {
            $('#Submit').attr('disabled', 'disabled');
            $('#Submit').addClass("subSectionOpacity");
            $(".loader").show();
            setTimeout(function (e) {
                if ($("#@Html.NameFor(m => m.CustomerDetails.IsNewCompany)").val() == 'False') {
                    if (!$("#newContactPersonInput").hasClass("hide-element") && $(".newContactPerson").val() == "") {
                        validationMessageFor("@Html.NameFor(m => m.CustomerDetails.UserId)", 'Contact Person is required');
                    }
                    else {
                        validationMessageFor("@Html.NameFor(m => m.CustomerDetails.UserId)", "");
                        $("#@Html.IdFor(m => m.CustomerDetails.Name)").val($(".newContactPerson").val());
                        $("#@Html.IdFor(m => m.CustomerDetails.PhoneNumber)").val($(".phoneNumber").val());
                        $("#@Html.IdFor(m => m.CustomerDetails.Email)").val($(".email").val());
                    }
                }

                // validate address
                var isAddressValid = validateLocationAddress();

                // End
                if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.OneTimeDelivery)' &&
                    $('#@Html.IdFor(m => m.FuelDeliveryDetails.SingleDeliverySubTypes) option:selected').val() == '@((int)SingleDeliverySubTypes.DeliveryDateRange)') {
                    $('#@Html.IdFor(m => m.FuelDeliveryDetails.IsOrderEndDateRequired)').val('True')
                }
                else {
                    $('#@Html.IdFor(m => m.FuelDeliveryDetails.IsOrderEndDateRequired)').val('False')
                }

                var isTierBasedPricingEnabled = $('#IsTierPricing').prop('checked');
                if (isTierBasedPricingEnabled) {
                    $('#@Html.IdFor(m => m.PricingDetails.PricePerGallon)').val(0);
                    $('#@Html.IdFor(m => m.PricingDetails.FuelPricingDetails.PricingCode.Id)').val(0);
                }
                var isFormValid = $form.valid();
                var quantityRangMsg = '@Resource.valMessageQuantityNotInRange';
                var greaterThanZeroMsg = '@string.Format(Resource.valMessageGreaterThanZero, Resource.lblGallons)';
                var isWeekendAndSpecialPriceValid = true;

                let isDespachRegion = true;
                var regionId = $("#@Html.IdFor(m => m.RegionId)").val();
                if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.OneTimeDelivery)'
                    && $('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val() == '@((int)Country.USA)') {
                    if (!regionId) {
                        $('#spnErrorRegionId').html('@(string.Format(Resource.ValidationDespacherRegion, "Region"))');
                        $('#spnErrorRegionId').removeClass('hide-element');
                        isDespachRegion = false;
                    }
                }
                else {
                    $('#spnErrorRegionId').html('');
                    $('#spnErrorRegionId').addClass('hide-element');
                }
                isFormValid = isFormValid && isAddressValid && isWeekendAndSpecialPriceValid && ValidateCityRackTerminal() && validateVessel() && isDespachRegion;


                if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.MultipleDeliveries)') {
                    var specialDateVal = '@((int)FeeConstraintType.SpecialDate)';
                    var specialDateErrorMsg = '@Resource.valMessageSpecialFeesDuplicate';
                    isWeekendAndSpecialPriceValid = validateWeekendAndSpecialFees(specialDateVal, specialDateErrorMsg);
                }


                if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() != '@((int)QuantityType.NotSpecified)') {
                    isFormValid = isFormValid && isAddressValid && isWeekendAndSpecialPriceValid && validateDeliverySchedule()
                        && ValidateRangeCoversTotalQuantity(quantityRangMsg)
                        && isQuantityGreaterThanZero(greaterThanZeroMsg) && ValidateCityRackTerminal() && validateVessel()
                }
                else {
                    isFormValid = isFormValid && isAddressValid && isWeekendAndSpecialPriceValid && ValidateCityRackTerminal() && validateVessel()
                }

                // validate tier based pricing
                    @*var isSupressOrderLevelPricingEnabled = '@(Model.PreferencesSetting != null ? Model.PreferencesSetting.IsSupressOrderPricing : false)';*@
                var isSupressOrderLevelPricingEnabled = $('#IsSupressOrderPricing').prop('checked');
                if (isSupressOrderLevelPricingEnabled) {
                    $('#@Html.IdFor(m => m.FuelOfferDetails.NetDays)').val(0);
                }
                if (isFormValid && !isSupressOrderLevelPricingEnabled) {
                    var isTierBasedPricingEnabled = $('#IsTierPricing').prop('checked');
                    if (isTierBasedPricingEnabled) {
                        isFormValid = validateTierBasedPricingAndQty();
                    }
                    else {
                        isFormValid = validateFRPricing();
                    }
                }

                if (isFormValid == true) {
                    var selectedPricingType = parseInt($('input[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"]:checked').val());
                    setSelectedCountryAndCurrency($('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val(), $('#@Html.IdFor(m => m.AddressDetails.Country.Currency)').val());
                    if (selectedPricingType == @((int)PricingType.Suppliercost)) {
                        GetGlobalCost(e, $form);
                    }
                    else {
                        validationMessageFor($("#@Html.IdFor(m => m.PricingDetails.PricingTypeId)").attr('name'), '');
                        if ($('#@Html.IdFor(m => m.AddressDetails.IsRetailJob)').is(':checked') == true) {
                            $('#delivery-schedule-section').find('.partial-block-collection-section').empty();
                        }

                        if (!$("#@Html.IdFor(m => m.BillToInfo.Name)").val() || !$("#@Html.IdFor(m => m.BillToInfo.Address)").val()) {
                            $('#Submit').removeAttr('disabled');
                            $('#Submit').removeClass("subSectionOpacity");
                            $('.loader').hide();
                            $('#billingAddressConfirmation').modal('toggle');
                            return;
                        }

                        //$form.data('validator').resetForm();
                        $form.submit();
                        $('.loader').show();
                    }
                }
                else {
                    //e.preventDefault();
                    showInvalidTab();
                }
                $.fn.focusWithoutScrolling = function () {
                    var x = window.scrollX, y = window.scrollY;
                    this.focus();
                    window.scrollTo(x, y);
                };
                if (!isFormValid) {
                    $(".field-validation-error:visible:first").closest(".form-group").find(".form-control").focus();
                    $('#Submit').removeAttr('disabled');
                    $('#Submit').removeClass("subSectionOpacity");
                    $('.loader').hide();
                }
                fixedButtons(this, isFormValid);
            }, 2);
        });

        onJobSpecificBillToSubmitt(false);

        $("#Draft").click(function () {
            var url = "@Url.Action("Draft", "Order", new { area = "Supplier" })";
            $("form").attr("action", url);
        });

        $("#@Html.IdFor(m => m.PricingDetails.TerminalName)").click(function () {
            var source = getPricingSource();
            if (source === @((int)PricingSource.Axxis)) {
                GetAxxisTerminals();
            }
        });

        $(".latitude,.longitude,#@Html.IdFor(m => m.FuelDetails.FuelTypeId)").change(function () {
            $("#@Html.IdFor(m => m.PricingDetails.TerminalName)").find("option:gt(0)").remove();
            var pricingTypeId = parseInt($('input[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"]:checked').val());
            latLongFuelTypeChanged = true;
            var isFtl = $('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').val() == '@((int)TruckLoadTypes.FullTruckLoad)';
            if ($(this).attr('id') == 'FuelDetails_FuelTypeId' && isFtl) {
                ToggleFscControlsByProductTypeId($(this).val());
            }
        });

        $(".ddterminallist").on('change', function () {
            $(this).attr('size', 1).css('width', '100%');
        });

        $(document).on('click', function () {
            $(".ddterminallist").attr("size", 1).css('width', '100%');
        });

        $("#@Html.IdFor(m => m.AddressDetails.Address)").change(function () {
            updateFuelTypesDropdown();
        });

        $(document).on("updated", ".country:not([data-billingCountry])", function (e) {
            var otherAddress = $(this).closest('.other-address');
            if (otherAddress != undefined && otherAddress.length > 0) {
                return;
            }
            updateFuelTypesDropdown();
            UpdateCurrencyAndUom($(this).val());
            UpdateOtherProductTaxesUoM();
        });

        $(".jobname").on("change", function () {

            if (isNewJobRadioChecked()) {
                $('#@Html.IdFor(m => m.AddressDetails.JobName)').val('');
                jobId = 0; isExistingJob = false;
                validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.JobName)").attr('name'), '');
                //$('#@Html.IdFor(m => m.AddressDetails.Country.Currency)').removeAttr('readonly');
                clearControls();
            }
            else {
                jobId = getJobIdFromDropdown(); var jobName = getJobNameFromDropdown();
                $('#@Html.IdFor(m => m.AddressDetails.JobName)').val(jobName);
                GetPortDetails(jobName);
                isExistingJob = true;
            }
        });

        $("#@Html.IdFor(m => m.AddressDetails.JobId)").change(function () {
            var jobId = parseInt($(this).val());
            if (isNaN(jobId) || jobId <= 0)
                return;
            var jobName = getJobNameFromDropdown();
            $('#@Html.IdFor(m => m.AddressDetails.JobName)').val(jobName);
            //$('#@Html.IdFor(m => m.AddressDetails.Country.Currency)').attr('readonly', 'readonly');
            GetPortDetails(jobName);
        });

        $("#@Html.IdFor(m => m.FuelDetails.FuelDisplayGroupId)").trigger('change');

        $(document).on('change', '.schedule-type', function () {
            var url = '@Url.Action("DeliverySchedule", "Order")';
            var data = $(this).val();
            var row = $(this).closest('.partial-block');
            $.get(url, { 'scheduleType': data, 'isThirdPartyCall': true }, function (response) {
                var newElement = $(response);
                newElement.find("input[type='text']:not([disabled]):not([readonly])").each(function () {
                    $(this).val('');
                });
                $(row).replaceWith(newElement);
                parseForm();
                documentReady(true);
                enableSubmit();
            });
        });
        $('.show-in-tpo').show();
        $('.hide-from-tpo').hide();
        $('.section-include-in-ppg').hide();
        $(document).ajaxComplete(function (event, xhr, settings) {
            $('.show-in-tpo').show();
            $('.hide-from-tpo').hide();
            $('.section-include-in-ppg').hide();
            $('.ddl-schedule-qty-type').removeClass('hide-element');
            UpdateDeliveryScheduleCarriers();
            UpdateOtherProductTaxesUoM();
        });

        $('#@Html.IdFor(m => m.AddressDetails.Country.Currency)').on('change', function () {
            UpdateCurrencyAndUom($(this).val());
        });

        $(".currency").on('currencyUpdated', function (event, currency, uom) {
            UpdateCurrencyAndUom(currency);
        });

        $('#csvFile').bind('change', function () {
            ValidateAssetUploadFileSize(this, parseInt('@Model.MaxAllowedFileSize'), "uploadOrdersButton", "divOrderFileSizeError");
        });

        $(document).on('StateChanged', function (e, stateCode) {
            if ($(e.target).hasClass("triggerTerminalChange")) {
                fillCityGroupTerminals($('#@Html.IdFor(m => m.AddressDetails.State.Id)').val());
            }
            updateDefaultQuantityIndicator($('#@Html.IdFor(m => m.AddressDetails.State.Id)').val());
            selected = allStates.find(function (x) { return x.StateCode == stateCode });
            if (selected) {
                $(e.target).find("option").filter(function (index) { return $(this).html() == selected.StateName; }).prop("selected", true);
            }
        });

        $('#@Html.IdFor(m => m.AddressDetails.State.Id)').change(function () {
            fillCityGroupTerminals($('#@Html.IdFor(m => m.AddressDetails.State.Id)').val());
        });

        $('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').on('change', function () {
            if ($('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').val() == '@((int)TruckLoadTypes.FullTruckLoad)') {
                $('#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsDriverToUpdateBOL)').prop('checked', true);
            }
            else {
                $('#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsDriverToUpdateBOL)').prop('checked', false);
            }
        });

        $('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.FreightOnBoardTypes)').on('change', function () {
            if ($('.freightOnBoardTypes').val() == '@((int)FreightOnBoardTypes.Terminal)' &&
                $('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').val() == '@((int)TruckLoadTypes.FullTruckLoad)') {
                enableVarious();
            }
            else if ($('#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)').val() == '@((int)TruckLoadTypes.FullTruckLoad)') {
                disableVarious();
            }
            else {
                disableVarious();
            }
        });

        $('.radio-rack-price').click(function () {
            var source = getPricingSource();
            var enablecityrack = $('.enablecityrack');
            if (source === @((int)PricingSource.OPIS)) {
                enablecityrack.prop('checked', false);
                enablecityrack.parent().addClass('pntr-none');
                enablecityrack.trigger('click');
            }
            else {
                enablecityrack.parent().removeClass('pntr-none');
            }
        });

        ToggleEndDate();

        inputBoxShowHide('new-company', 'existing-company');
        setOnboardingPrefDefaultSetting();

        ShowTrailerType('@Html.IdFor(m => m.TrailerType)');
        $('.divTrailerType').hide();
        if ($('#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)').prop('checked')) {
            $(".existingjobSection").hide();
        }

        $('input[name="@Html.NameFor(m => m.CustomerDetails.Name)"]').val('@Model.CustomerDetails.Name');

        applyCssToMultiSelect();
        if ($('#radio-newcustomer').is(':checked'))
            $(".existingjobSection").hide();

        $('#@Html.IdFor(m => m.AddressDetails.IsRetailJob)').trigger('change');

        $(document).on('change', $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes)"), function () {
            var prefId = parseInt($('input[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes)"]:checked').val());
            if (prefId != @((int)InvoiceNotificationPreferenceTypes.SendPDIDeliveryDetails)) {
                $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsIncludePricing)").addClass('pntr-none subSectionOpacity');
                $('input[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.IsIncludePricing)"]').prop('checked', false);
            }
            else {
                $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsIncludePricing)").removeClass('pntr-none subSectionOpacity');
            }
        });

        $(document).on('change', '.country', function () {
            var countryId = parseInt($(this).val());
            var container = $(this).closest('.address-container');
            if (container != undefined && container.length > 0) {
                if (!isNaN(countryId) && countryId == '@((int)Country.CAR)') {
                    container.find('.mandatory-symbol').addClass('hide-element');
                }
                else {
                    container.find('.mandatory-symbol').removeClass('hide-element');
                }
            }
        });

        $(document).on('blur', '.address-type', function () {
            var eleVal = $.trim($(this).val());
            if (eleVal != undefined && eleVal != null && eleVal != '') {
                var span = $(this).closest('div').find('span.field-validation-error');
                if (!span.hasClass('hide-element'))
                    span.addClass('hide-element');
            }
        });
        $('.country').trigger('change');
        var isGeocodeUsed = $('[name="@Html.NameFor(m => m.AddressDetails.IsGeocodeUsed)"]').prop('checked');
        if (isGeocodeUsed) {
            $('[name="@Html.NameFor(m => m.AddressDetails.IsGeocodeUsed)"]').trigger('click');
        }

        var curr = $("#@Html.IdFor(m => m.AddressDetails.Country.Currency)").val();
        if (curr == '@((int)Currency.USD)')
            $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Gallons)");
        else
            $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Litres)");
        $("#@Html.IdFor(m => m.AddressDetails.Country.Currency)").change(function () {
            if ($("#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)").val() == 'True') {
                var currency = $(this).val();
                if (currency == '@((int)Currency.USD)') {
                    // for usa
                    //$('#@Html.IdFor(M => M.AddressDetails.MarineUoM)').children('option[value="@((int)UoM.Litres)"]').hide();
                    //$('#@Html.IdFor(M => M.AddressDetails.MarineUoM)').children('option[value="@((int)UoM.Gallons)"]').show();
                    $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Gallons)");

                    //UOM in quantity section
                    //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Litres)"]').hide();
                    //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Gallons)"]').show();
                    $('#MFNQuantityUoM').val("@((int)UoM.Gallons)");
                    $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Gallons)");

                }
                else {
                    // for canada
                    //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Litres)"]').show();
                    //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Gallons)"]').hide();
                    $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Litres)");
                    //UOM in quantity section
                    //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Litres)"]').show();
                    //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Gallons)"]').hide();
                    $('#MFNQuantityUoM').val("@((int)UoM.Litres)");
                    $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Litres)");

                }
            }
        });

        $('#MFNQuantityUoM').change(function (event) {
            var selectedVal = event.target.value;
            if (selectedVal === '@((int)UoM.Gallons)') {
                $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Gallons)");
            }
            else if (selectedVal === '@((int)UoM.Litres)') {
                $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Litres)");
            }
            else if (selectedVal === '@((int)UoM.Barrels)') {
                $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Barrels)");
            }
            else if (selectedVal === '@((int)UoM.MetricTons)') {
                $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.MetricTons)");
            }

            // set location level UOM
            $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val(selectedVal);
            $("#@Html.IdFor(m => m.AddressDetails.Country.UoM)").val(selectedVal);
        });
        $("#@Html.IdFor(m => m.PricingDetails.PricePerGallon)").on('keypress', function (event) {
            var defaultUoM = parseInt($('#MFNQuantityUoM').val());

            if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
                event.preventDefault();
            }

            if (defaultUoM == 4) {

                var input = $(this).val();
                if ((input.indexOf('.') != -1) && (input.substring(input.indexOf('.')).length > 2)) {
                    event.preventDefault();
                }
            }
            else {

                var input = $(this).val();
                if ((input.indexOf('.') != -1) && (input.substring(input.indexOf('.')).length > 4)) {
                    event.preventDefault();
                }
            }
        });

        var jobid = parseInt($("#@Html.IdFor(m => m.AddressDetails.JobId)").val());
        if (!isNaN(jobid) && jobid > 0) {
            $("#@Html.IdFor(m => m.AddressDetails.JobId)").trigger('change');
        }

        $(document).on('change', $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)"), function () {
            checkCompanyExists();
        });
        if (isSupressOrderLevelPricingEnabled) {
            $('#@Html.IdFor(m => m.FuelOfferDetails.NetDays)').val(0);
        }

        $('.taxForOtherFuel').removeAttr("style").addClass("hide-element");
    });

    function setOnboardingPrefDefaultSetting() {
        var isSupressOrderLevelPricingEnabled = $('#IsSupressOrderPricing').prop('checked');
        if (isSupressOrderLevelPricingEnabled) {
            var defaultPricingTypeId = parseInt('@((int)PricingType.PricePerGallon)');
            $('input:radio[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"][value=' + defaultPricingTypeId + ']').prop('checked', true).trigger('click');
            $("#@Html.IdFor(m => m.PricingDetails.PricePerGallon)").val(0);
            $('input:radio[name="@Html.NameFor(m => m.FuelOfferDetails.PaymentTermId)"][value=' + @((int)PaymentTerms.NetDays) + ']').prop('checked', true).trigger('click');
            $('input:radio[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes)"][value=' + @((int)InvoiceNotificationPreferenceTypes.SendDDTWithBillingFile) + ']').prop('checked', true);
            $('.section-pricing, #div-fuel-surcharge-section, #div-invoice-notification-instructions, .thirdparty-fees, .fuel-request-fees, #div-payment-terms, .taxForOtherFuel').addClass('hide-element');
            $('.taxForOtherFuel').removeAttr("style").addClass("hide-element");
            hidePDITaxControls();
            $("#OrderAdditionalDetailsViewModel_BOLInvoicePreferenceTypes").val('@((int)InvoiceNotificationPreferenceTypes.None)');
            $('input[name="@Html.NameFor(m => m.OrderAdditionalDetailsViewModel.BOLInvoicePreferenceTypes)"]').prop('checked', true);
        }
        else if (getProductDisplayGroupId() == 3 || getProductDisplayGroupId() == 7) {
            $('.taxForOtherFuel').removeAttr("style").removeClass("hide-element");
        }
    }

    function showHideonSuppresspricingCheckbox(ele) {
        if ($(ele).prop("checked") === true) {
            $('input:checkbox[name="@Html.NameFor(m => m.IsSupressOrderPricing)"]').val('true');
            $('.section-pricing, #div-fuel-surcharge-section, #div-invoice-notification-instructions, .thirdparty-fees, .fuel-request-fees, #div-payment-terms, .supplier-allowence').addClass('hide-element');
            setOnboardingPrefDefaultSetting();
            hidePDITaxControls();
            $('#@Html.IdFor(m => m.FuelOfferDetails.NetDays)').val(0);
            $('.taxForOtherFuel').removeAttr("style").addClass("hide-element");
        } else {
            $('input:checkbox[name="@Html.NameFor(m => m.IsSupressOrderPricing)"]').val('false');
            $('.section-pricing, #div-fuel-surcharge-section, #div-invoice-notification-instructions, .thirdparty-fees, .fuel-request-fees, #div-payment-terms, .supplier-allowence').removeClass('hide-element');

            if (getProductDisplayGroupId() != 3 && getProductDisplayGroupId() != 7) {
                showPDITaxControls();
            }
            $('#@Html.IdFor(m => m.FuelOfferDetails.NetDays)').val('');
            if (getProductDisplayGroupId() == 3 || getProductDisplayGroupId() == 7) {
                $('.taxForOtherFuel').removeAttr("style").removeClass("hide-element");
            }
        }
    }

        function validateScheduleQuantityType(ele) {
            var selectedType = $(ele).val();
            var container = $(ele).closest('.schedule-type-container').find('.schedule-qty-container');
            if (selectedType == '@((int)ScheduleQuantityType.Quantity)') {
                container.find('.quantity').val('');
                container.removeClass('hide-element');
            }
            else {
                container.find('.quantity').val(0.01);
                container.addClass('hide-element');
            }

            return false;
        }

        function ValidateCityRackTerminal() {
            var isValid = true;
            if ($('input.enablecityrack[type="checkbox"]').prop("checked") == true) {
                var citygroupId = $("#@Html.IdFor(m => m.PricingDetails.CityGroupTerminalId)").val();
                if (citygroupId == 0 || citygroupId == undefined || citygroupId == 'undefined') {
                    isValid = false;
                    validationMessageFor('@Html.NameFor(m => m.PricingDetails.CityGroupTerminalId)', '@Resource.valMessageTerminalIsRequired');
                }
            }
            return isValid;
        }

        function ToggleEndDate() {
            var selectedDeliveryType = $('#@Html.IdFor(m => m.FuelDeliveryDetails.DeliveryTypeId):checked').val();
            var selectedDeliverySubType = $('#@Html.IdFor(m => m.FuelDeliveryDetails.SingleDeliverySubTypes) option:selected').val();
            if (selectedDeliveryType == '@((int)DeliveryType.OneTimeDelivery)' && selectedDeliverySubType == '@((int)SingleDeliverySubTypes.DeliveryDateRange)') {
                $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').removeAttr('disabled');
                $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').removeAttr('readonly');
                $('.end-date').removeClass('subSectionOpacity');
            }
            else {
                $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').val('');
                $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').attr('disabled', 'disabled');
                $('.end-date').removeClass('subSectionOpacity');
                $('#@Html.IdFor(m => m.FuelDeliveryDetails.EndDate)').attr('readonly', 'readonly');
            }
		}

        function CloseOrderWhen() {
            $('.order-close-threshold').hide();
            if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() != '@((int)QuantityType.NotSpecified)'
                && $('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.MultipleDeliveries)') {
                $('.order-close-threshold').show();
            }
        }

        function UpdateCurrencyAndUom(currencyId) {
            var currency = @((int)Currency.CAD);
            if (currencyId == currency) {
                setCanadaCurrencyAndUom();
            }
            else {
                setUsaCurrencyAndUom();
            }
        }

        function GetAxxisTerminals() {
            var fuelId = $("#@Html.IdFor(m => m.FuelDetails.FuelTypeId)").val();
            fuelId = (fuelId == undefined || fuelId == null || fuelId == '' ? 0 : fuelId);

            var inputData = {
                fuelTypeId: fuelId,
                latitude: $("#@Html.IdFor(m => m.AddressDetails.Latitude)").val(),
                longitude: $("#@Html.IdFor(m => m.AddressDetails.Longitude)").val(),
				countryId: $("#@Html.IdFor(m => m.AddressDetails.Country.Id)").val(),
                pricingCodeId: $("#@Html.IdFor(m => m.PricingDetails.FuelPricingDetails.PricingCode.Id)").val(),
                terminal: '',
                pricingSourceId: $("#@Html.IdFor(m => m.PricingDetails.FuelPricingDetails.PricingSourceId)").val()
            };

            var terminalUrl = "@Url.Action("GetClosedTerminal", "Order", new { area = "Supplier" })";
            autoCompleteTerminal("#@Html.IdFor(m => m.PricingDetails.TerminalName)", terminalUrl, inputData);
        }

        function GetOpisTerminals() {
            var inputData;
            var source = getPricingSource();
            if ($('#AddressDetails_IsVarious').is(':checked')) {
                inputData = {
                    cityRackId: $('.cityrackterminallist').val(),
                    terminal: '',
                    source: source
                };
            }
            else {
                inputData = {
                    latitude: $("#@Html.IdFor(m => m.AddressDetails.Latitude)").val(),
                    longitude: $("#@Html.IdFor(m => m.AddressDetails.Longitude)").val(),
                    countryId: $("#@Html.IdFor(m => m.AddressDetails.Country.Id)").val(),
                    terminal: '',
                    source: source
                };
            }

           var terminalUrl = "@Url.Action("GetOpisTerminals", "Order", new { area = "Supplier" })";
           autoCompleteTerminal("#@Html.IdFor(m => m.PricingDetails.TerminalName)", terminalUrl, inputData);
        }

        function autoCompleteTerminal(element, url, inputData) {

            var target = $(element);
            var prevTerminal = $(element).val();
            var terminalId = 0;
            var isSelected = false;

            target
                .autocomplete({
                source: function (request, response) {
                    inputData.terminal = request.term;
                    inputData.cityRackId = $('.cityrackterminallist').val();
                    $.ajax({
                        url: url,
                        type: "GET",
                        dataType: "json",
                        data: inputData,
                        success: function (data) {
                            response($.map(data, function (item) {
                                return {
                                    label: item.Name,
                                    value: item.Id
                                };
                            }))
                        },
                        complete: function (event, xhr, settings) {
                            $(".ddterminal-loader").hide();
                        }
                    })
                },
                select: function (event, ui) {
                    isSelected = true;
                    $(target).val(ui.item.label); // display the selected text
                    terminalId = ui.item ? ui.item.value : 0;
                    prevTerminal = ui.item ? ui.item.label : prevTerminal;
                    if (terminalId != 0)
                        $("#@Html.IdFor(m => m.PricingDetails.TerminalId)").val(terminalId);
                    return false;
                },
                messages: {
                    noResults: '',
                    results: function () { }
                },
                minLength: 2,
                maxShowItems: 10,
                scroll: true
            });
            $.ui.autocomplete.prototype._resizeMenu = function () {
                var ul = this.menu.element;
                ul.outerWidth(this.element.outerWidth());
            }

            target.autocomplete("search", "  ");
        }

        function populateTerminals(response, target) {
            target.empty(), $.each(response, function (i, element) {
                target.append($('<option></option>').val(element.Id).html(element.Name));
            });
        }

        function IsPhoneNumberValid(phoneNumber) {
            var new_phoneNumber = phoneNumber.replace(/-|\s/g, "");
            if (new_phoneNumber != "" && new_phoneNumber.length == 10) {
                var isPhoneNumberValid = '@Url.Action("IsPhoneNumberValid", "Validation", new { area = "" })' + '?phoneNumber=' + phoneNumber;
                $.get(isPhoneNumberValid, function (result) {
                    if (!result) {
                        validationMessageFor("@Html.NameFor(m => m.CustomerDetails.PhoneNumber)", '');
                        $("#mobile-validation-msg").html('@Resource.valMessagePhoneNotValid');
                        $('#@Html.IdFor(m => m.CustomerDetails.IsPhoneNumberConfirmed)').val(false);
                    } else {
                        $("#mobile-validation-msg").html('');
                        $('#@Html.IdFor(m => m.CustomerDetails.IsPhoneNumberConfirmed)').val(true);
                    }
                });
            }
            else {
                $("#mobile-validation-msg").html('');
            }
        }

        function UpdateFeeSectionWithLitres() {
            $('.fee-types').find('.input-group-addon').each(function () {
                $(this).text('@(Currency.CAD.ToString())');
            });
            $('.fee-types').find('option').each(function () {
                $(this).text($(this).text().replace('@(UoM.Gallons.ToString())', '@(UoM.Litres.ToString())'));
            });
            $('.fee-types').find('.chk-include-ppg').each(function () {
                $(this).text('@Resource.lblIncludeInPPL');
            });
        }

        function UpdateFeeSectionWithGallons() {
            $('.fee-types').find('.input-group-addon').each(function () {
                $(this).text('@(Currency.USD.ToString())');
            });
            $('.fee-types').find('option').each(function () {
                $(this).text($(this).text().replace('@(UoM.Litres.ToString())', '@(UoM.Gallons.ToString())'));
            });
            $('.fee-types').find('.chk-include-ppg').each(function () {
                $(this).text('@Resource.lblIncludeInPPG');
            });
        }

    function setCanadaCurrencyAndUom() {
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.Currency)").val('@((int)Currency.CAD)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.UoM)").val('@((int)UoM.Litres)');
            $("#@Html.IdFor(m => m.ExternalBrokeredOrder.BrokeredOrderFee.Currency)").val('@((int)Currency.CAD)');
            $("#@Html.IdFor(m => m.ExternalBrokeredOrder.BrokeredOrderFee.UoM)").val('@((int)UoM.Litres)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.FuelSurchargeFreightFee.Currency)").val('@((int)Currency.CAD)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.FuelSurchargeFreightFee.UoM)").val('@((int)UoM.Litres)');

            $('.uom').text('@(UoM.Litres.ToString())');
            $('.currency-symbol').text('@(Currency.CAD.ToString())');
            updateDefaultUrls('@((int)Currency.CAD)', '@((int)UoM.Litres)');
            UpdateFeeSectionWithLitres();
            $('.allowance').text('@(Currency.CAD.ToString())/@Resource.lblPerLitre');
            if ($("#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)").val() == 'True') {
                //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Litres)"]').show();
                //$("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").children('option[value="@((int)UoM.Gallons)"]').hide();
                $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Litres)");
                //UOM in quantity section
                //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Litres)"]').show();
                //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Gallons)"]').hide();
                //$('#MFNQuantityUoM').val("@((int)UoM.Litres)");
               // $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Litres)");
            }
        }

    function setUsaCurrencyAndUom() {
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.Currency)").val('@((int)Currency.USD)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.UoM)").val('@((int)UoM.Gallons)');
            $("#@Html.IdFor(m => m.ExternalBrokeredOrder.BrokeredOrderFee.Currency)").val('@((int)Currency.USD)');
            $("#@Html.IdFor(m => m.ExternalBrokeredOrder.BrokeredOrderFee.UoM)").val('@((int)UoM.Gallons)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.FuelSurchargeFreightFee.Currency)").val('@((int)Currency.USD)');
            $("#@Html.IdFor(m => m.FuelDeliveryDetails.FuelFees.FuelSurchargeFreightFee.UoM)").val('@((int)UoM.Gallons)');
            $('.uom').text('@(UoM.Gallons.ToString())');
            $('.currency-symbol').text('@(Currency.USD.ToString())');
            updateDefaultUrls('@((int)Currency.USD)', '@((int)UoM.Gallons)');
            UpdateFeeSectionWithGallons();
            $('.allowance').text('@(Currency.USD.ToString())/@Resource.lblPerGallon');
            //marine
            if ($("#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)").val() == 'True') {
                //$('#@Html.IdFor(M => M.AddressDetails.MarineUoM)').children('option[value="@((int)UoM.Litres)"]').hide();
                //$('#@Html.IdFor(M => M.AddressDetails.MarineUoM)').children('option[value="@((int)UoM.Gallons)"]').show();
                $("#@Html.IdFor(M => M.AddressDetails.MarineUoM)").val("@((int)UoM.Gallons)");

                //UOM in quantity section
                //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Litres)"]').hide();
                //$('#MFNQuantityUoM').children('option[value="@((int)UoM.Gallons)"]').show();
               // $('#MFNQuantityUoM').val("@((int)UoM.Gallons)");
                //$('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)').val("@((int)UoM.Gallons)");
            }
        }

        function UpdateOtherProductTaxesUoM() {
            if ($('.country').val() == '@((int)Country.CAN)') {
                $('.ddl-other-product-tax').find('option').each(function () {
                    $(this).text($(this).text().replace('@Resource.lblPerGallon', '@Resource.lblPerLitre'));
                });
                $('.taxesRow').find('.input-group-addon').each(function () {
                    $(this).text($(this).text().replace('@(Currency.USD.ToString())', '@(Currency.CAD.ToString())'));
                });
            }
            else {
                $('.ddl-other-product-tax').find('option').each(function () {
                    $(this).text($(this).text().replace('@Resource.lblPerLitre', '@Resource.lblPerGallon'));
                });
                $('.taxesRow').find('.input-group-addon').each(function () {
                    $(this).text($(this).text().replace('@(Currency.CAD.ToString())', '@(Currency.USD.ToString())'));
                });
            }
        }

      

        function getPortsByCountry(ele) {
            var target = $("#@Html.IdFor(m => m.AddressDetails.JobId)");
            var currVal = $("#@Html.IdFor(m => m.AddressDetails.JobId)").val();
            var countryId = parseInt($(ele).val());
            if (countryId != 1)
            {
              $('#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsPdiTaxRequired)').prop('checked', false);
            }
            else {
                $('#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsPdiTaxRequired)').prop('checked', true);
            }
            $('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val(countryId);
            clearValidationMessageForAddressControls();
            clearControls();

            var billingAdd = $("#jobSpecificBillAddress");
            billingAdd.html('');
            $("#jobSpecificBillInfoWell").hide();
            $("#jobSpecificBillToButton").show();

            $.get("@Url.Action("GetJobList", "Order", new { area = "Supplier" })",
                { companyName: '', isFtl: false, isFoAsTerminal: false, supplierUserId: '@CurrentUser.Id', supplierCompanyId: '@CurrentUser.CompanyId', isPort: true, countryId: countryId },
                function (response) {
                    target.empty(), $.each(response, function (i, element) {
                        target.append($('<option></option>').val(element.Id).html(element.Name));
                    });

                    $(target).prepend("<option value selected='selected'>@string.Format(@Resource.valMessageSelect, @Resource.lblPort)</option>");
                    $(target).val(currVal);
                });
        }

        function GetPortDetails(name) {
            if (name == 'Select Job') {
                clearControls(); $(".address-controls").addClass("subSectionOpacity");
                return;
            }
            $(".address-controls").addClass("subSectionOpacity");
            $(".company-owned").addClass("pntr-none");
            $(".tpo-addressloader").show();
            $("#external-ponumber").show();
            var portId = parseInt($("#@Html.IdFor(m => m.AddressDetails.JobId)").val(), 10);
            $.get("@Url.Action("GetPortDetails", "Order", new { area = "Supplier" })", { portId: portId },
                function (response) {
                    if (response.Job.Id > 0) {
                        clearValidationMessageForAddressControls();
                        $('#@Html.IdFor(m => m.AddressDetails.DisplayJobID)').val(response.Job.JobID);
                        $('#@Html.IdFor(m => m.AddressDetails.WBSNumber)').val(response.Job.WBSNumber);

                        $('#@Html.IdFor(m => m.AddressDetails.Address)').val(response.Job.Address);
                        $('#@Html.IdFor(m => m.AddressDetails.City)').val(response.Job.City);
                        $('#@Html.IdFor(m => m.AddressDetails.CountyName)').val(response.Job.CountyName);

                        if (response.Job.Country.Id != '@((int)Country.CAR)')
                            $('#@Html.IdFor(m => m.AddressDetails.ZipCode)').val(response.Job.ZipCode);

                        $('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val(response.Job.Country.Id).trigger('change');
                        $('#@Html.IdFor(m => m.AddressDetails.Latitude)').val(response.Job.Latitude);
                        $('#@Html.IdFor(m => m.AddressDetails.Longitude)').val(response.Job.Longitude);
                        $('#@Html.IdFor(m => m.AddressDetails.TimeZoneName)').val(response.Job.TimeZoneName);
                        $('#@Html.IdFor(m => m.AddressDetails.Country.Currency)').val(response.Job.Country.Currency);

                        $('#@Html.IdFor(m => m.AddressDetails.IsProFormaPoEnabled)').prop('checked', response.Job.IsProFormaPoEnabled);
                        $('#@Html.IdFor(m => m.AddressDetails.MarineUoM)').val(response.Job.MarineUom);
                        $('#@Html.IdFor(m => m.AddressDetails.IsRetailJob)').prop('checked', response.Job.IsRetailJob);

                        $('#@Html.IdFor(m => m.AddressDetails.State.Id)').trigger('change');
                        $('#@Html.IdFor(m => m.AddressDetails.State.Id)').val(response.Job.State.Id)

                        if (response.RegionId != null && response.RegionId != '') {
                            $('#@Html.IdFor(m=>m.RegionId)').val(response.RegionId);
                            $('#@Html.IdFor(m=>m.RegionId)').attr('readonly', true);
                        } else {
                            $('#@Html.IdFor(m=>m.RegionId)').removeAttr('readonly');
                        }

                        if (response.Job.IsRetailJob && isExistingJob) {
                            $("#delivery-schedule-section").hide();
                        } else {
                            $("#delivery-schedule-section").show();
                        }

                        if (response.Job.IsProFormaPoEnabled) {
                            $("#external-ponumber").hide();
                        }

                        $('#@Html.IdFor(m => m.IsTaxExempted)').prop('checked', response.JobBudget.IsTaxExempted);

                        updateMapData();
                        updateFuelTypesDropdown();
                        GetCityRackTerminalList($('#@Html.IdFor(m => m.AddressDetails.State.Id)').val(), false);
                        $(".tpo-addressloader").hide(); $(".address-controls").addClass("subSectionOpacity");
                        $(".company-owned").addClass("pntr-none");

                        var countryCurrency = @((int)Currency.CAD);
                        if (response.Job.Country.Currency == countryCurrency) {
                            setCanadaCurrencyAndUom();
                        }
                        else {
                            setUsaCurrencyAndUom();
                        }
                        GetJobSpecificBillingAddress();
                    }
                    else if (isNewJobRadioChecked() == false) {
                        clearControls(); $(".address-controls").addClass("subSectionOpacity");
                        $(".company-owned").addClass("pntr-none");
                    }
                });
        }

        function clearValidationMessageForAddressControls() {
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.Address)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.City)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.CountyName)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.ZipCode)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.Country.Id)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.State.Id)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.Latitude)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.Longitude)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.TimeZoneName)").attr('name'), '');
            validationMessageFor($("#@Html.IdFor(m => m.AddressDetails.JobId)").attr('name'), '');
        }

        function clearControls() {
            $('#@Html.IdFor(m => m.AddressDetails.DisplayJobID)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.WBSNumber)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.Address)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.City)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.CountyName)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.ZipCode)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.State.Id)').val($('#@Html.IdFor(m => m.AddressDetails.State.Id) option:first').val());
            $('#@Html.IdFor(m => m.AddressDetails.Latitude)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.Longitude)').val('');
            $('#@Html.IdFor(m => m.AddressDetails.TimeZoneName)').val('');
            $(".tpo-addressloader").hide();
            $("#external-ponumber").show();
            $('#@Html.IdFor(m => m.AddressDetails.IsProFormaPoEnabled)').prop('checked', false);
            $(".combineDiv input,.combineDiv select").removeClass("pntr-none").removeAttr("readonly");
            $(".timeZoneName").addClass("pntr-none").attr("readonly", "readonly");
            target = $("#@Html.IdFor(m => m.PricingDetails.TerminalName)");
            target.empty();
            target.prepend("<option value selected='selected'>@Resource.lblSelectTerminal</option>");
            $('#@Html.IdFor(m => m.AddressDetails.IsRetailJob)').prop('checked',false).trigger('change');
            $('.divCarrierAssign').removeClass("pntr-none subSectionOpacity");

            $('input:radio[id="@Html.IdFor(m => m.AddressDetails.LocationManagedType)"][value = @LocationManagedType.NotSpecified]').prop('checked', true);
            $('#location-managed').removeClass("pntr-none subSectionOpacity");
        }

        function GetGlobalCost(e, $form) {
            var selectedFuelTypeId = $("#@Html.IdFor(m => m.FuelDetails.FuelTypeId)").val();
            var jobStateId = $("#@Html.IdFor(m => m.AddressDetails.State.Id)").val();
            var currencyId = $("#@Html.IdFor(m => m.AddressDetails.Country.Currency)").val();
            var quantityTypeId = $('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val();
            var isMarine = $("#@Html.IdFor(m => m.FuelDetails.IsMarineLocation)").val();
            var uom = $("#@Html.IdFor(m => m.AddressDetails.Country.UoM)").val();
            if (quantityTypeId ==@((int)QuantityType.NotSpecified)&& isMarine == 'True')
                uom = $("#@Html.IdFor(m => m.AddressDetails.MarineUoM)").val();
            else if (quantityTypeId !=@((int)QuantityType.NotSpecified)&& isMarine == 'True')
                uom = $("#@Html.IdFor(m => m.FuelDetails.FuelQuantity.UoM)").val();

            $.get("@Url.Action("GetGlobalFuelCost", "Order", new { area = "Supplier" })",
                {
                    fuelTypeId: selectedFuelTypeId,
                    jobStateId: jobStateId,
                    uom: uom,
                    currency: currencyId
                },
                function (response) {
                    if (response != 0) {
                        validationMessageFor($("#@Html.IdFor(m => m.PricingDetails.PricingTypeId)").attr('name'), '');
                        $form.submit();
                    }
                    else {

                        validationMessageFor($("#@Html.IdFor(m => m.PricingDetails.PricingTypeId)").attr('name'), '@ResourceMessages.GetMessage(Resource.ErrorGlobalCostNotProvided)');
                        msgerror('@Resource.ErrorGlobalCostNotProvided');
                        if (e) { e.preventDefault(); }
                        showInvalidTab();
                        $('#Submit').removeAttr('disabled');
                        $('#Submit').removeClass('subSectionOpacity');
                        $('.loader').hide();
                    }

                });
        }

        function validateDeliverySchedule()
        {
            var isValidForm = true;
            var fuelRequestStartDate = $('#@Html.IdFor(t => t.FuelDeliveryDetails.StartDate)').val();
			var fuelRequestStartTime = $('#@Html.IdFor(t => t.FuelDeliveryDetails.StartTime)').val();
            var startDate = new Date(fuelRequestStartDate).setHours(0, 0, 0, 0);
            var quantity = 0, totalQuantity = 0;
            if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() == '@((int)QuantityType.SpecificAmount)') {
                quantity = parseInt($("#@Html.IdFor(m => m.FuelDetails.FuelQuantity.Quantity)").val(), 10);
            }
            else  if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() == '@((int)QuantityType.Range)') {
                quantity = parseInt($("#@Html.IdFor(m => m.FuelDetails.FuelQuantity.MaximumQuantity)").val(), 10);
            }

			var frStartTimeinMin = getMinutes(convertTo24Hour(fuelRequestStartTime));
            $(".endtime").each(function () {
                var endTimeVal = $(this).val();
                var startTimeVal = $(this).parents('.partial-block').find('.starttime').val();
                if (endTimeVal != '' && startTimeVal != '' && endTimeVal != startTimeVal) {
                    var startTimevalInMinutes = getMinutes(convertTo24Hour(startTimeVal));
                    var endTimevalInMinutes = getMinutes(convertTo24Hour(endTimeVal));
                    if (parseInt(startTimevalInMinutes) > parseInt(endTimevalInMinutes)) {
                        validationMessageFor($(this).attr('name'), '@ResourceMessages.GetMessage(Resource.valMessageGreaterThanOrEqual, new object[] { Resource.lblEndTime, Resource.lblStartTime })');
                        isValidForm = false;
                    }
                }
            });
            //deleting all rows which are not visible
            var scheduleType;
            $('#delivery-schedule-section .partial-block').each(function () {
                scheduleType = $(this).find('.schedule-type').val();
				var date = $(this).find('.schedule-date').val();
				var scheduleStartTime = $(this).find('.starttime').val();

                if (scheduleType == '@((int)DeliveryScheduleType.Weekly)' || scheduleType == '@((int)DeliveryScheduleType.BiWeekly)') {
                    totalQuantity += parseInt($(this).find('.quantity').val()) * $(this).find('.schedule-days').val().length;
                }
                else
                {
                    totalQuantity += parseInt($(this).find('.quantity').val());
                }
                if (scheduleType == '@((int)DeliveryScheduleType.SpecificDates)' || scheduleType == '@((int)DeliveryScheduleType.Monthly)') {
                    var scheduleDate = new Date(date).setHours(0, 0, 0, 0);
                    if (scheduleDate < startDate) {
                        validationMessageFor($(this).find('.datepicker').attr('name'),
                            '@ResourceMessages.GetMessage(Resource.valMessageScheduleDate)');
                        isValidForm = false;
					}
					if (scheduleType == '@((int)DeliveryScheduleType.SpecificDates)' && scheduleDate == startDate)
					{
						var scheduleStartTimeinMin = getMinutes(convertTo24Hour(scheduleStartTime));
                        if (parseInt(frStartTimeinMin) > parseInt(scheduleStartTimeinMin))
						{
							validationMessageFor($(this).find('.starttime').attr('name'),
                            '@ResourceMessages.GetMessage(Resource.valMessageInvalid, new object[] { Resource.lblStartTime })');
							isValidForm = false;
						}
					}
                }
            });
            if (totalQuantity > quantity)
            {
                validationMessageFor($('#delivery-schedule-section .partial-block:last').find('.quantity').attr('name'),
                                         '@ResourceMessages.GetMessage(Resource.valMessageScheduleQuantity)');
                return false;
            }
            return isValidForm;
        }

        function GoToPreviousURL() {
            window.history.go(-1);
        }

        var priviousCityTerminalId = '@Model.FuelDetails.FuelPricing.CityGroupTerminalId';
        function assignNewCityGroupTerminal() {
            var selectedCityTerminal = parseInt($('#@Html.IdFor(m => m.PricingDetails.CityGroupTerminalId)').val());
            var jobId = getJobIdFromDropdown();
            var source = getPricingSource();
            if (priviousCityTerminalId != selectedCityTerminal && selectedCityTerminal > 0) {
                validationMessageFor('@Html.NameFor(m => m.PricingDetails.CityGroupTerminalId)', '');
                $(".cityrack-validation").addClass("hide-element");
                var url = '@Url.Action("IsCityGroupTerminalPriceAvailable", "FuelRequest")';
                var data = {
                    jobid: isNaN(jobId) ? 0 : jobId,
                    fueltypeId: parseInt($("#@Html.IdFor(m => m.FuelDetails.FuelTypeId)").val()),
                    selectedCityRackId: selectedCityTerminal,
                    lattitude: parseFloat($("#@Html.IdFor(m => m.AddressDetails.Latitude)").val()),
                    longitude: parseFloat($("#@Html.IdFor(m => m.AddressDetails.Longitude)").val()),
                    countryCode: $("#@Html.IdFor(m => m.AddressDetails.Country.Id) option:selected").text(),
                    sourceId: source
                };
                if (data.fueltypeId > 0 && (data.jobid > 0 || (!isNaN(data.lattitude) && !isNaN(data.longitude)))) {
                    $(".cityrack-loader").show();
                    $.get(url, data, function (response) {
                        if (response === false) {
                            validationMessageFor('@Html.NameFor(m => m.PricingDetails.CityGroupTerminalId)', '@Resource.errMessageTerminalPriceNotAvailable');
                            $('#@Html.IdFor(m => m.PricingDetails.CityGroupTerminalId)').multiselect('select', ['noneselected']);
                            $(".cityrack-validation").removeClass("hide-element");
                        }
                        else {
                            validationMessageFor('@Html.NameFor(m => m.PricingDetails.CityGroupTerminalId)', '');
                            $(".cityrack-validation").addClass("hide-element");
                            $('#@Html.IdFor(m => m.PricingDetails.CityGroupTerminalStateId)').val(selectedCityTerminal);
                        }
                        $(".cityrack-loader").hide();
                        priviousCityTerminalId = selectedCityTerminal;
                    });
                }
            }
            if (source != @((int)PricingSource.Axxis)) {
                GetOpisTerminals();
            }
        }

        function GetCompanyDetails(companyId, companyName) {
            var target = $(".existingContactPerson");
              if ($("#@Model.CustomerDetails.IsNewCompany").val() == 'False') {
                if ('@Model.CustomerDetails.CompanyId' != companyId || '@Model.CustomerDetails.Name' == '' || '@Model.CustomerDetails.UserId' > 0)
                { CreateExistingContactPerson(); }
                else
                {
                    CreateNewContactPerson();
                    $('input[name="@Html.NameFor(m => m.CustomerDetails.Name)"]').val('@Model.CustomerDetails.Name');
                    $(".phoneNumber").val('@Model.CustomerDetails.PhoneNumber');
                    $(".email").val('@Model.CustomerDetails.Email');
                }
            }
			if (companyId != "" && companyId > 0) {
                $(".customer-contact").show();
                $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val(companyName);

                var url = '@Url.Action("GetTPOCompanyContactPersons", "Order", new { Area = "Supplier" })';
                $.get(url, { companyId: companyId }, function (response) {
                        target.empty(), $.each(response, function (i, element) {
                            target.append($('<option></option>').val(element.Id).html(element.Name));
                            $(".customer-contact").hide();
                    });
                    $(target).prepend("<option value selected='selected'>@string.Format(@Resource.valMessageSelect, @Resource.lblContactPerson)</option>");
                    if ($.parseJSON('@Model.CustomerDetails.UserId.HasValue.ToString().ToLower()' && '@Model.CustomerDetails.CompanyId' == companyId) && '@Model.CustomerDetails.Name' == '') {
                        $("select#CustomerDetails_UserId").val("@Model.CustomerDetails.UserId");
                        $("select#CustomerDetails_UserId").trigger('change');
                    }
                });

                @*url = '@Url.Action("GetTPOCompanyBillingAddress", "Order", new { Area = "Supplier" })';
                $.get(url, { companyId: companyId }, function (response) {
                    billingAddressId = response.Id;
                    $("#@Html.IdFor(m => m.BillingAddress.Id)").val(response.Id);
                    $("#@Html.IdFor(m => m.BillingAddress.ZipCode)").val(response.ZipCode);
                    $(".billingZipCode").trigger("change");
                    $("#@Html.IdFor(m => m.BillingAddress.Address)").val(response.Address);
                    $("#@Html.IdFor(m => m.BillingAddress.City)").val(response.City);
                    $("#@Html.IdFor(m => m.BillingAddress.Country)").val(response.Country.Id);
                    $("#@Html.IdFor(m => m.BillingAddress.State)").val(response.State.Id);
                    if (response.Id > 0) {
                        $("#@Html.IdFor(m => m.BillingAddress.IsBillingAddressRequired)").val(true);
                        isCustomBillingAddressAllowed = false;
                        $('#lbl-chk-billing-address').addClass('pl0');
                    }
                    else {
                        isCustomBillingAddressAllowed = true;
                        $('#lbl-chk-billing-address').removeClass('pl0');
                    }
                     $('#chk-billing-address').show();
                     if (isTileCollapsed('billing-address')) {
                            toggleTileElement(null, 'billing-address');
                        }

                    ClearBillingAddress(isCustomBillingAddressAllowed);
                });*@
            }
			else {
                target.empty();
                $(target).prepend("<option value selected='selected'>@string.Format(@Resource.valMessageSelect, @Resource.lblContactPerson)</option>");
            }
        }

        function GetContactPersonDetails(contactPerson) {
            $(".phoneNumber").val('');
            $(".email").val('');
            var contactPersonId = $(contactPerson).val();
            if (contactPersonId != "" && contactPersonId > 0) {
                var url = '@Url.Action("GetTPOContactPersonDetails", "Order", new { Area = "Supplier" })';
                $.get(url, { userId: contactPersonId }, function (response) {
                    $(".phoneNumber").val(response.PhoneNumber);
                    $(".email").val(response.Email);
                    $("#@Html.IdFor(m => m.CustomerDetails.PhoneNumber)").val(response.PhoneNumber);
                    $("#@Html.IdFor(m => m.CustomerDetails.Email)").val(response.Email);
                    $("#@Html.IdFor(m => m.CustomerDetails.Name)").val(response.Name);
                    if (!response.IsPhoneNumberConfirmed) {
                        $("#mobile-validation-msg").html('@Resource.valMessagePhoneNotValid');
                    }
                    else {
                        $("#mobile-validation-msg").html('');
                    }
                });
            }
        }

        function SetJobValues() {
            if (!isNewJobRadioChecked() && $.parseJSON("@Model.AddressDetails.JobId.HasValue.ToString().ToLower()")) {
                $("select#@Html.IdFor(m => m.AddressDetails.JobId)").val("@Model.AddressDetails.JobId");
                        $("select#@Html.IdFor(m => m.AddressDetails.JobId)").trigger("change");
            }
        }

        function DisableNotRequired(isNewCompany) {
            $(".newContactPerson").val('');
            $(".existingContactPerson").empty().prepend("<option value selected='selected'>@string.Format(@Resource.valMessageSelect, @Resource.lblContactPerson)</option>");
            if (!isNewCompany) {
                CreateExistingContactPerson();
            }
            else {
                $("#@Html.IdFor(m => m.AddressDetails.IsNewJob)").click();
            }
        }

        function CreateNewContactPerson() {
            $(".phoneNumber").prop("readonly", false);
            $(".email").prop("readonly", false);
            $(".phoneNumber").val('');
            $(".email").val('');
            $(".existing-company").addClass("hide-element");
            $(".existing-company").hide();
            $(".new-company").removeClass("hide-element");
            $("#useExisting").show();
            $(".new-company").show();
            $("#mobile-validation-msg").html('');
        }

        function CreateExistingContactPerson() {
            $(".phoneNumber").prop("readonly", true);
            $(".email").prop("readonly", true);
            $("#useExisting").hide();
            $(".existing-company").removeClass("hide-element");
            $(".existing-company").show();
            var numCompanyId = parseInt($("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val(), 10);
            var selectedCompanyId = (isNaN(numCompanyId) ? 0 : numCompanyId);
            var selectedCompanyName = $("#@Html.IdFor(m => m.CustomerDetails.CompanyId) option:selected").text();
            GetCompanyDetails(selectedCompanyId, selectedCompanyName);
            $(".new-company").addClass("hide-element");
            validationMessageFor("@Html.NameFor(m => m.CustomerDetails.PhoneNumber)", '');
            validationMessageFor("@Html.NameFor(m => m.CustomerDetails.Email)", '');
        }

        function SetSpecialMinDate(element) {
            var requestMinDate = $('#@Html.IdFor(m => m.FuelDeliveryDetails.StartDate)').val();
            if (requestMinDate == undefined || requestMinDate == "") { requestMinDate = '@Model.FuelDeliveryDetails.StartDate' || '@DateTimeOffset.Now'; }
            $(element).closest('.fee-types').find('.special-date').data("DateTimePicker").minDate(moment(requestMinDate).startOf('d'));
        }

        function updateFuelTypesDropdown() {
            var address = getAddress();
            if (address != undefined) {
                zipCode = address; // It is for getting fuel type on change of product display group
                jobId = getJobIdFromDropdown();
                if (isNewJobRadioChecked()) { jobId = 0; isExistingJob = false; }
            }
        }

        function getAddress() {
            var address = undefined;
            var state = $("#@Html.IdFor(m => m.AddressDetails.State.Id)");
            if (state.val() == '') { return address; }

            address = $("#@Html.IdFor(m => m.AddressDetails.Address)").val() + " " +
                $("#@Html.IdFor(m => m.AddressDetails.City)").val() + " " +
                $("#@Html.IdFor(m => m.AddressDetails.State.Id) option:selected").text() + " " +
                $("#@Html.IdFor(m => m.AddressDetails.Country.Id) option:selected").text() + " " + getZipcode();

            return address;
        }

        function getJobIdFromDropdown() {
            var numJobId = parseInt($("#@Html.IdFor(m => m.AddressDetails.JobId)").val(), 10);
            return (isNaN(numJobId) ? 0 : numJobId);
        }
        function getJobNameFromDropdown() {
            return $("#@Html.IdFor(m => m.AddressDetails.JobId) option:selected").text();
        }
        function isNewJobRadioChecked() {
            return $('.jobname[value="True"]').is(':checked');
        }
        function getZipcode() {
            return $("#@Html.IdFor(m => m.AddressDetails.ZipCode)").val();
        }
        function getProductDisplayGroupId() {
            return parseInt($('input[name="@Html.NameFor(m => m.FuelDetails.FuelDisplayGroupId)"]:checked').val(), 10);
		}

		function setStateValue(element)
		{
			var selectedState = $(element).val();
			var states = $('[name="@Html.NameFor(m => m.AddressDetails.State.Id)"]');
			$(states).first().val(selectedState);
			$(states).last().val(selectedState);
			GetCityRackTerminalList(selectedState, false);
			if ($('input:checkbox[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').is(":checked") == true)
			{
				var state = $(states).find("option:selected").first().text();
				var country = $('[name="@Html.NameFor(m => m.AddressDetails.Country.Id)"]').find('option:selected').text();
				GetLatLong(state, country);
            }
            updateDefaultQuantityIndicator(selectedState);
        }

        function updateDefaultQuantityIndicator(selectedState) {
            var stateInformation = $.grep(allStates, function (v) {
                return v.StateId == selectedState;
            });

            if (stateInformation.length == 0)
                return;

            if ('@((int)Model.FuelDetails.FuelQuantity.QuantityIndicatorTypes > 0)' == 'True') {
                defaultQuantityIndicator = '@((int)Model.FuelDetails.FuelQuantity.QuantityIndicatorTypes)';
            }
            else {
                defaultQuantityIndicator = stateInformation[0].QuantityIndicatorId;
            }

            $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.QuantityIndicatorTypes)').val(defaultQuantityIndicator);
            $('#@Html.IdFor(m => m.FuelDetails.FuelQuantity.QuantityIndicatorTypes)').trigger('change');
        }

		function CheckAddBillingAddress(ischecked)
		{
			if (ischecked && $("#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)").val() == 'True') {
				$('#BillingAddress_IsBillingAddressRequired').prop('checked', true);
				$('#BillingAddress_IsBillingAddressRequired').attr('readonly', 'readonly');
			}
			else
			{
				$('#BillingAddress_IsBillingAddressRequired').prop('checked', false);
				$('#BillingAddress_IsBillingAddressRequired').removeAttr('readonly');
			}
			toggleBillingAddressControls($('#BillingAddress_IsBillingAddressRequired'));
        }

        function checkCompanyExists() {
            var isNewCmp = $('#radio-newcustomer').prop('checked');
            var cmpName = $('#@Html.IdFor(m => m.CustomerDetails.CompanyName)').val();
            if (isNewCmp && cmpName != null && cmpName != '') {
                validateCompanyName(isNewCmp, cmpName);
            }
        }

        function isExistingCompanyRadioSelected(isExisting) {
            if (isExisting) {
                $(".existingjobSection").show();
                var numCompanyId = parseInt($("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val(), 10);
                var selectedCompanyId = (isNaN(numCompanyId) ? 0 : numCompanyId);
                var selectedCompanyName = $("#@Html.IdFor(m => m.CustomerDetails.CompanyId) option:selected").text();
                if (numCompanyId > 0) {
                    LoadExistingAddress();
                    $('#lnkSurchargeTable').removeClass('pntr-none subSectionOpacity');
                    inputBoxShowHide('existing-company', 'new-company');
                    focusOnFirst(null, 'existing-company');
                    GetCompanyDetails(selectedCompanyId, selectedCompanyName);
                    DisableNotRequired(false);
                    ClearBillingAddress(false);
                    $("#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)").val(false);
                    customerCompany = selectedCompanyId;
                    $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val(selectedCompanyId);
                    $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val(selectedCompanyName);
                    toggleRegularBuyerDetails(selectedCompanyId);
                } else {
                    customerCompany = '';
                    $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val(0);
                    $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val('');
                    setCompanyTypeValidation();
                    $('#lnkSurchargeTable').addClass('pntr-none subSectionOpacity');
                }

            } else {
                $("#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)").val(true);
                $(".existingjobSection").hide();
                $("#useExisting").hide()
                $("#mobile-validation-msg").html('');
                customerCompany = '';
                $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val(0);

                $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val('');
                $('#lnkSurchargeTable').addClass('pntr-none subSectionOpacity');
                inputBoxShowHide('new-company', 'existing-company');
                $("#@Html.IdFor(m => m.CustomerDetails.UserId)").val('');
                setCompanyTypeValidation();
                toggleBuyerDetails(true);
            }
            resetPortAndAddress();
        }
            function toggleRegularBuyerDetails(companyId) {
            let isTpoBuyer = false;
            $('.loader').show();
            $.get("@Url.Action("IsValidTpoCompany", "Order",new { area="Supplier" })", { companyId: companyId },
                function (response) {
                    isTpoBuyer = response;
                }).always(function (x) {
                    toggleBuyerDetails(isTpoBuyer);
                    $('.loader').hide();
                });
        }
        function toggleBuyerDetails(isTpoBuyer) {
            if (isTpoBuyer) {
                $(".enable-tpo-buyer").show();
                $(".tpo-enabled").removeClass('pntr-none subSectionOpacity');
                if (@Model.IsSupressOrderPricing && !$('#IsSupressOrderPricing').prop('checked')) {
                    $("#IsSupressOrderPricing").trigger('click');
                }
            } else {
                $(".enable-tpo-buyer").hide();
                $("#radio-existingjob").trigger('click');
                //$("#radio-newcontact").trigger('click');
                if ($('#IsSupressOrderPricing').prop('checked')) {
                    $("#IsSupressOrderPricing").trigger('click');
                }
                $(".tpo-enabled").addClass('pntr-none subSectionOpacity');

            }
        }
    function resetPortAndAddress() {
            $("#@Html.IdFor(m => m.AddressDetails.JobId)").val('');
            $("select#@Html.IdFor(m => m.AddressDetails.JobId)").trigger("change");
            $("#@Html.IdFor(m => m.BillToInfo.Address)").val('');
            onJobSpecificBillToSubmitt(false)
        }

        function setCompanyTypeValidation() {
            var companyName = $("#@Html.IdFor(m => m.CustomerDetails.CompanyName)").val();
            var companyId = parseInt($("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val());

            if (isNaN(companyId) || companyId <= 0) {
                inputBoxShowHide('new-company', 'existing-company');
                DisableNotRequired(true);
                ClearBillingAddress(true);
                $("#@Html.IdFor(m => m.CustomerDetails.IsNewCompany)").val(true);
                $(".phoneNumber").prop("readonly", false);
                $(".email").prop("readonly", false);
            }
        }

        function onJobTypeChange(element) {
			if ($(element).is(':checked')) {
                $('.multi-delivery').hide();
			}
			else {
                $('.multi-delivery').show();
                //$("#location-managed").hide();

                //$('#tpoJobForcasting').hide();
                $("#idAccountLevelForcastingEnabled").prop("checked", false);
            }
		}

        function GetJobSpecificBillingAddress() {
            var billingAdd = $("#jobSpecificBillAddress");
            billingAdd.html('');
            $("#@Html.IdFor(m => m.BillToInfo.Name)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.Address)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.AddressLine2)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.AddressLine3)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.City)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.State.Name)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.ZipCode)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.County)").val('');
            $("#@Html.IdFor(m => m.BillToInfo.Country.Name)").val('');

            var jobid = parseInt($("#@Html.IdFor(m => m.AddressDetails.JobId)").val());
            var custId = $("#@Html.IdFor(m => m.CustomerDetails.CompanyId)").val();
            if (!isNaN(jobid) && jobid > 0) {
                var url = '@Url.Action("GetJobSpecificBillingAddressDetails", "Order", new { Area = "Supplier" })';
                $.get(url, { jobId: jobid, customerId:custId }, function (response) {
                    if (response.Name != "" && response.Name != null) {
                        $("#jobSpecificBillName").html(response.Name);
                        $("#@Html.IdFor(m => m.BillToInfo.BillingAddressId)").val(response.BillingAddressId);
                        $('#radio-existingBillAddress').val(true);
                        $("#radio-existingBillAddress").prop("checked", true).trigger('click');
                        $("#selection-list-billing-Address").removeClass('hide-element');
                        $("#@Html.IdFor(m => m.BillToInfo.Name)").val(response.Name);

                        if (response.Address != "" && response.Address != null) {
                            billingAdd.append(", " + response.Address);
                            $("#@Html.IdFor(m => m.BillToInfo.Address)").val(response.Address);
                        }

                        if (response.AddressLine2 != "" && response.AddressLine2 != null) {
                            billingAdd.append(", " + response.AddressLine2);
                            $("#@Html.IdFor(m => m.BillToInfo.AddressLine2)").val(response.AddressLine2);
                        }

                        if (response.AddressLine3 != "" && response.AddressLine3 != null) {
                            billingAdd.append(", " + response.AddressLine3);
                            $("#@Html.IdFor(m => m.BillToInfo.AddressLine3)").val(response.AddressLine2);
                        }

                        if (response.City != "" && response.City != null) {
                            billingAdd.append(", " + response.City);
                            $("#@Html.IdFor(m => m.BillToInfo.City)").val(response.City);
                        }
                         if (response.State.Name != "" && response.State.Name != null) {
                            billingAdd.append(", " + response.State.Name);
                            $("#@Html.IdFor(m => m.BillToInfo.State.Name)").val(response.State.Name);
                        }

                        if (response.ZipCode != "" && response.ZipCode != null) {
                            billingAdd.append(", " + response.ZipCode);
                            $("#@Html.IdFor(m => m.BillToInfo.ZipCode)").val(response.ZipCode);
                        }

                        if (response.County != "" && response.County != null) {
                            billingAdd.append(", " + response.County);
                            $("#@Html.IdFor(m => m.BillToInfo.County)").val(response.County);
                        }
                        if (response.Country.Name != "" && response.Country.Name != null) {
                            billingAdd.append(", " + response.Country.Name);
                            $("#@Html.IdFor(m => m.BillToInfo.Country.Name)").val(response.Country.Name);
                        }

                        var addr = billingAdd.html().slice(2);
                        billingAdd.html(addr);

                        $("#jobSpecificBillInfoWell").show();
                        $("#jobSpecificBillToButton").hide();
                        MakeItNonEditable(true);
                    }
                    else {
                        $("#jobSpecificBillInfoWell").hide();
                        $("#jobSpecificBillToButton").show();
                    }
                });
            }
        }

    function onJobSpecificBillToSubmitt(isSubmitClicked) {
        //set popup values to Model
        var address = $("#@Html.IdFor(m => m.BillToInfo.Address)").val();
        if (!isSubmitClicked && (address == undefined || address == '')) {
            $("#@Html.IdFor(m => m.BillToInfo.State.Id)").val(0);
            $("#@Html.IdFor(m => m.BillToInfo.Country.Id)").val(0);
            $("#jobSpecificBillName").html('');
            $("#jobSpecificBillAddress").html('');
            $("#jobSpecificBillInfoWell").hide();
            $("#jobSpecificBillToButton").show();
        }
        else {
            if ($("#@Html.IdFor(m => m.BillToInfo.Name)").val() == null || $("#@Html.IdFor(m => m.BillToInfo.Name)").val() == "") {
                validationMessageFor("@Html.NameFor(m => m.BillToInfo.Name)", '@ResourceMessages.GetMessage(Resource.valMsgNameRequired)');
                $("#JobSpecificBillToSubmit").removeAttr('data-dismiss');
                return;
            }

            if ($("#@Html.IdFor(m => m.BillToInfo.Address)").val() == null || $("#@Html.IdFor(m => m.BillToInfo.Address)").val() == "") {
                validationMessageFor("@Html.NameFor(m => m.BillToInfo.Address)", '@ResourceMessages.GetMessage(Resource.valMsgAddressRequired)');
                $("#JobSpecificBillToSubmit").removeAttr('data-dismiss');
                return;
            }

            var billingAdd = $("#jobSpecificBillAddress");
            billingAdd.html('');
            $("#jobSpecificBillName").html($("#@Html.IdFor(m => m.BillToInfo.Name)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.Address)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.Address)").val());
             if ($("#@Html.IdFor(m => m.BillToInfo.AddressLine2)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.AddressLine2)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.AddressLine3)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.AddressLine3)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.City)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.City)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.State.Name)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.State.Name)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.ZipCode)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.ZipCode)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.County)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.County)").val());
            if ($("#@Html.IdFor(m => m.BillToInfo.Country.Name)").val())
                billingAdd.append(", " + $("#@Html.IdFor(m => m.BillToInfo.Country.Name)").val());

            var addr = billingAdd.html().slice(2);
            billingAdd.html(addr);

            $("#jobSpecificBillInfoWell").show();
            $("#jobSpecificBillToButton").hide();

            var attr = $("#JobSpecificBillToSubmit").attr('data-dismiss');
            if (typeof attr === typeof undefined && attr != 'modal') {
                $("#JobSpecificBillToSubmit").attr('data-dismiss', 'modal');
            }
        }
    }

        function GetLocationManagedType(locationType)
        {
            var response;
            switch (locationType) {
              case 0:
                response = '@LocationManagedType.NotSpecified';
                break;
              case 1:
                response = '@LocationManagedType.SupplierManaged';
                break;
              case 2:
                response = '@LocationManagedType.PartialCarrierManaged';
                break;
              case 3:
                response = '@LocationManagedType.FullyCarrierManaged';
                break;
            }

            return response;
        }

        function validateTierBasedPricingAndQty() {
            var isValid = true;
            var tierPricingRows = $('.tier-fuel-quantity-row');
            if (tierPricingRows != undefined && tierPricingRows != null && tierPricingRows.length > 0) {
                $.each(tierPricingRows, function (idx, pricingRow) {
                    var toQty = parseFloat($(pricingRow).find('.to-quantity').val());
                    var fromQty = parseFloat($(pricingRow).find('.from-quantity').val());
                    var pricingCodeId = parseInt($(pricingRow).find('.tierPricingCodeId').val());
                    var pricingTypeId = parseInt($(pricingRow).find('.tierPricingTypeId').val());
                    var rackPrice = parseFloat($(pricingRow).find('.tierRackPrice').val());
                    var supplierCost = parseFloat($(pricingRow).find('.tierSupplierCostMarkupValue').val());
                    var pricePerGallon = parseFloat($(pricingRow).find('.tierPricePerGallon').val());
                    var isAboveQuantity = $(pricingRow).find('.tierIsAboveQuantity').val();
                    var rowIdx = parseInt($(pricingRow).attr('rowIndex'));

                    // update tier pricing fuel type if line item fueltype and selected fueltype are different
                    var fuelTypeId = parseInt($("#@Html.IdFor(m => m.FuelDetails.FuelTypeId)").val());
                    var pricingFuelTypeId = parseInt($(pricingRow).find('.tierFuelTypeId').val());
                    if (!isNaN(fuelTypeId) && !isNaN(pricingFuelTypeId) && fuelTypeId != pricingFuelTypeId)
                        $(pricingRow).find('.tierFuelTypeId').val(fuelTypeId);

                    if (!(isAboveQuantity == 'True') && (isNaN(toQty) || toQty <= 0)) { // validate above quantity
                        isValid = false;
                        validationMessageFor($(pricingRow).find('.to-quantity').attr('name'), '@Resource.valMessageQuantityRequired');
                    }
                    else if (isNaN(pricingCodeId) || pricingCodeId <= 0) { // validate pricing code
                        isValid = false;
                        $(pricingRow).find('.lbl-error-msg').text('@Resource.valMessagePricingCodeRequied');
                        $(pricingRow).find('.pricing-error-section').removeClass('hide-element');
                    }
                    else if (pricingTypeId == @((int)PricingType.PricePerGallon) && (isNaN(pricePerGallon) || pricePerGallon <= 0)) { // validate PPG
                        isValid = false;
                        $(pricingRow).find('.lbl-error-msg').text('@Resource.valMessagePricingIsRequired');
                        $(pricingRow).find('.pricing-error-section').removeClass('hide-element');
                    }
                    else if (pricingTypeId == @((int)PricingType.RackAverage) && (isNaN(rackPrice) || rackPrice < 0)) { // validate rack pricing
                        isValid = false;
                        $(pricingRow).find('.lbl-error-msg').text('@Resource.valMessagePricingIsRequired');
                        $(pricingRow).find('.pricing-error-section').removeClass('hide-element');
                    }
                    else if (pricingTypeId == @((int)PricingType.Suppliercost) && (isNaN(supplierCost) || supplierCost < 0)) { // validate supplier cost
                        isValid = false;
                        $(pricingRow).find('.lbl-error-msg').text('@Resource.valMessagePricingIsRequired');
                        $(pricingRow).find('.pricing-error-section').removeClass('hide-element');
                    }

                    if (!isValid)
                        return isValid;
                });

                if (isValid)
                    isValid = setQuantity(false);
            }

            return isValid;
        }

        function validateFRPricing() {
            var isValid = true;
            var pricingTypeId = parseInt($('input[name="@Html.NameFor(m => m.PricingDetails.PricingTypeId)"]:checked').val());
            var pricingCodeId = parseInt($("#@Html.IdFor(m => m.PricingDetails.FuelPricingDetails.PricingCode.Id)").val());
            var rackAvgTypeId = parseInt($("#@Html.IdFor(m => m.PricingDetails.RackAvgTypeId)").val());

            var ppg = 0;
            if (pricingTypeId == @((int)PricingType.RackAverage)) {
                var ppg = parseFloat($("#@Html.IdFor(m => m.PricingDetails.RackPrice)").val());
                if (isNaN(ppg) || ppg < 0) {
                    validationMessageFor('@Html.NameFor(m => m.PricingDetails.RackPrice)', '@Resource.valMessagePricingIsRequired');
                    isValid = false;
                }
            }
            else if (pricingTypeId == @((int)PricingType.Suppliercost)) {
                var ppg = parseFloat($("#@Html.IdFor(m => m.PricingDetails.SupplierCostMarkupValue)").val());
                if (isNaN(ppg) || ppg < 0) {
                    validationMessageFor('@Html.NameFor(m => m.PricingDetails.SupplierCostMarkupValue)', '@Resource.valMessagePricingIsRequired');
                    isValid = false;
                }
            }
            else if (pricingTypeId == @((int)PricingType.PricePerGallon)) {
                ppg = parseFloat($("#@Html.IdFor(m => m.PricingDetails.PricePerGallon)").val());
                if (isNaN(ppg) || ppg <= 0) {
                    validationMessageFor('@Html.NameFor(m => m.PricingDetails.PricePerGallon)', '@Resource.valMessagePricingIsRequired');
                    isValid = false;
                }
            }
            else if (isNaN(pricingCodeId) || pricingCodeId <= 0) {
                validationMessageFor('@Html.NameFor(m => m.PricingDetails.FuelPricingDetails.PricingCode.Code)', '@Resource.valMessagePricingCodeRequied');
                isValid = false;
            }
            return isValid;
        }

        function setControlsEditableForCaribbean(ele) {
            var countryId = parseInt($("#@Html.IdFor(m => m.AddressDetails.Country.Id)").val());
            if (!isNaN(countryId) && countryId == '@((int)Country.CAR)') {
                $("#@Html.IdFor(m => m.AddressDetails.Country.Id)").removeClass('pntr-none');
                $("#@Html.IdFor(m => m.AddressDetails.CountryGroupId)").removeClass('pntr-none');
            }
        }

        function validateLocationAddress() {
            var isValid = true;
            var isVariousLocation = $('[name="@Html.NameFor(m => m.AddressDetails.IsVarious)"]').prop('checked');
            var countryId = parseInt($('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val());
            var isGeocodeUsed = $('[name="@Html.NameFor(m => m.AddressDetails.IsGeocodeUsed)"]').prop('checked');
            var latitude = $.trim($("#@Html.IdFor(m => m.AddressDetails.Latitude)").val());
            var longitude = $.trim($("#@Html.IdFor(m => m.AddressDetails.Longitude)").val());
            var address = $.trim($("#@Html.IdFor(m => m.AddressDetails.Address)").val());
            var stateId = parseInt($("#@Html.IdFor(m => m.AddressDetails.State.Id)").val());
            var isBillingAddressRequired = $('[name="@Html.NameFor(m => m.BillingAddress.IsBillingAddressRequired)"]').prop('checked');
            $('.address-validation-error').addClass('hide-element');

            if (isVariousLocation || countryId == '@((int)Country.CAR)') {
                if (countryId == '@((int)Country.CAR)') {
                    if (isGeocodeUsed) {
                        if (latitude == '') {
                            $('#spnErrorLatitude').html('@(string.Format(Resource.valMessageRequired, "Latitude"))');
                            $('#spnErrorLatitude').removeClass('hide-element');
                            isValid = false;
                        }
                        if (longitude == '') {
                            $('#spnErrorLongitude').html('@(string.Format(Resource.valMessageRequired, "Longitude"))');
                            $('#spnErrorLongitude').removeClass('hide-element');
                            isValid = false;
                        }

                        if (isNaN(stateId) || stateId <= 0)
                            $('#@Html.IdFor(m => m.AddressDetails.State.Id)')[0].selectedIndex = 1;
                    }
                    else {
                        if (isNaN(stateId) || stateId <= 0) {
                            validationMessageFor('@Html.NameFor(m => m.AddressDetails.State)', '@(string.Format(Resource.valMessageRequired, "State"))');
                            isValid = false;
                        }
                    }

                    // copy state name
                    $("#@Html.IdFor(m => m.AddressDetails.State.Name)").val($("#@Html.IdFor(m => m.AddressDetails.State.Id) option:selected").text());
                }
                else {
                    if (isNaN(stateId) || stateId <= 0) {
                        validationMessageFor('@Html.NameFor(m => m.AddressDetails.State)', '@(string.Format(Resource.valMessageRequired, "State"))');
                        isValid = false;
                    }
                }

                var bollToStateId = parseInt($("#@Html.IdFor(m => m.BillToInfo.State.Id)").val());
                if (isNaN(bollToStateId) || bollToStateId <= 0)
                    $('#@Html.IdFor(m => m.BillToInfo.State.Id)')[0].selectedIndex = 1;
            }
            else {
                var city = $.trim($("#@Html.IdFor(m => m.AddressDetails.City)").val());
                var zipCode = $.trim($("#@Html.IdFor(m => m.AddressDetails.ZipCode)").val());
                var countyName = $.trim($("#@Html.IdFor(m => m.AddressDetails.CountyName)").val());

                if (address == '') {
                    $('#spnErrorAddress').html('@(string.Format(Resource.valMessageRequired, "Address"))');
                    $('#spnErrorAddress').removeClass('hide-element');
                    isValid = false;
                }
                if (city == '') {
                    $('#spnErrorCity').html('@(string.Format(Resource.valMessageRequired, "City"))');
                    $('#spnErrorCity').removeClass('hide-element');
                    isValid = false;
                }
                if (isNaN(stateId) || stateId <= 0) {
                    validationMessageFor('@Html.NameFor(m => m.AddressDetails.State)', '@(string.Format(Resource.valMessageRequired, "State"))');
                    isValid = false;
                }
                if (zipCode == '') {
                    $('#spnErrorZipCode').html('@(string.Format(Resource.valMessageRequired, "ZipCode"))');
                    $('#spnErrorZipCode').removeClass('hide-element');
                    isValid = false;
                }
                if (countyName == '') {
                    $('#spnErrorCountyName').html('@(string.Format(Resource.valMessageRequired, "CountyName"))');
                    $('#spnErrorCountyName').removeClass('hide-element');
                    isValid = false;
                }
                if (latitude == '') {
                    $('#spnErrorLatitude').html('@(string.Format(Resource.valMessageRequired, "Latitude"))');
                    $('#spnErrorLatitude').removeClass('hide-element');
                    isValid = false;
                }
                if (longitude == '') {
                    $('#spnErrorLongitude').html('@(string.Format(Resource.valMessageRequired, "Longitude"))');
                    $('#spnErrorLongitude').removeClass('hide-element');
                    isValid = false;
                }

                var bollToStateId = parseInt($("#@Html.IdFor(m => m.BillToInfo.State.Id)").val());
                if (isNaN(bollToStateId) || bollToStateId <= 0)
                    $('#@Html.IdFor(m => m.BillToInfo.State.Id)')[0].selectedIndex = 1;
            }

            if (isVariousLocation) {
                var billingCity = $.trim($("#@Html.IdFor(m => m.BillingAddress.City)").val());
                var billingZipCode = $.trim($("#@Html.IdFor(m => m.BillingAddress.ZipCode)").val());
                var billingAddress = $.trim($("#@Html.IdFor(m => m.BillingAddress.Address)").val());

                if (billingAddress == '') {
                    $('#spnErrorBillingAddress').html('@(string.Format(Resource.valMessageRequired, "Address"))');
                    $('#spnErrorBillingAddress').removeClass('hide-element');
                    isValid = false;
                }
                if (billingCity == '') {
                    $('#spnErrorBillingCity').html('@(string.Format(Resource.valMessageRequired, "City"))');
                    $('#spnErrorBillingCity').removeClass('hide-element');
                    isValid = false;
                }

                if (billingZipCode == '') {
                    $('#spnErrorBillingZipCode').html('@(string.Format(Resource.valMessageRequired, "ZipCode"))');
                    $('#spnErrorBillingZipCode').removeClass('hide-element');
                    isValid = false;
                }
            }

            if (isValid)
                $('.address-validation-error').addClass('hide-element');

            return isValid;
        }

        function getVesselDetails(vesselEle) {
            var vesselId = parseInt($(vesselEle).val());
            if (!isNaN(vesselId) && vesselId > 0) {
                var url = '@Url.Action("GetVesselDetails", "Order", new { Area = "Supplier" })';
                $.get(url, { vesselId: vesselId }, function (response) {
                    if (response != null && response.StatusCode == '@((int)Status.Success)') {
                        $('#@Html.IdFor(m => m.AddressDetails.IMONumber)').val(response.ResponseData.IMONumber);
                        $('#@Html.IdFor(m => m.AddressDetails.Flag)').val(response.ResponseData.Flag);
                        $('#spnErrorVessel').html('');
                        $('#spnErrorIMONumber').html('');
                    }
                    else {
                        $('#@Html.IdFor(m => m.AddressDetails.IMONumber)').val('');
                        $('#@Html.IdFor(m => m.AddressDetails.Flag)').val('');
                    }
                });
            }
            else {
                $('#@Html.IdFor(m => m.AddressDetails.IMONumber)').val('');
                $('#@Html.IdFor(m => m.AddressDetails.Flag)').val('');
            }
    }

    function removeRegionValidation() {
        if ($('input[name="@Html.NameFor(m => m.FuelDeliveryDetails.DeliveryTypeId)"]:checked').val() == '@((int)DeliveryType.OneTimeDelivery)'
            && $('#@Html.IdFor(m => m.AddressDetails.Country.Id)').val() == '@((int)Country.USA)') {
            $('#MandatoryRegionId').removeClass('hide-element');
            if ($('input[name="@Html.NameFor(m => m.FuelDetails.FuelQuantity.QuantityTypeId)"]:checked').val() == '@((int)QuantityType.SpecificAmount)') {
                $('#subdr-count').show();
            }
            else {
                $('#subdr-count').hide();
            }
        }
        else {
            $('#spnErrorRegionId').html('');
            $('#spnErrorRegionId').addClass('hide-element');
            $('#MandatoryRegionId').addClass('hide-element');
            $('#subdr-count').hide();
        }
    }

        function validateVessel() {
            var isValid = true;
            var vesselId = parseInt($("#@Html.IdFor(m => m.AddressDetails.VessleId)").val());
            var imoNumber = $.trim($("#@Html.IdFor(m => m.AddressDetails.IMONumber)").val());

            if (isNaN(vesselId) || vesselId <= 0) {
                $('#spnErrorVessel').html('@(string.Format(Resource.valMessageRequired, "Vessel"))');
                $('#spnErrorVessel').removeClass('hide-element');
                isValid = false;
            }

            @*if (imoNumber == '' || imoNumber == null || imoNumber == undefined) {
                $('#spnErrorIMONumber').html('@(string.Format(Resource.valMessageRequired, "IMO Number"))');
                $('#spnErrorIMONumber').removeClass('hide-element');
                isValid = false;
            }*@

            return isValid;
        }

        $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualBDNConfirmationRequired)").on("change", function (e) {
            if ($(this).is(":checked")) {
                $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualInvoiceConfirmationRequired)").prop("checked", true);
                $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualInvoiceConfirmationRequired)").addClass('pntr-none subSectionOpacity')
            }
            else {
                if ($("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualInvoiceConfirmationRequired)").hasClass('pntr-none subSectionOpacity')) {
                    $("#@Html.IdFor(m => m.OrderAdditionalDetailsViewModel.IsManualInvoiceConfirmationRequired)").removeClass('pntr-none subSectionOpacity')
                }
            }
        });

</script>

    <script type="text/javascript">
        var truckLoadDropDown = $("#@Html.IdFor(m => m.FuelDetails.FuelPricing.FuelPricingDetails.TruckLoadTypes)");
        var quantityIndicatorDropDown = $("#@Html.IdFor(m => m.FuelDetails.FuelQuantity.QuantityIndicatorTypes)");
        var defaultQuantityIndicator = '@((int)Model.FuelDetails.FuelQuantity.QuantityIndicatorTypes > 0 ? (int)Model.FuelDetails.FuelQuantity.QuantityIndicatorTypes : (int)QuantityIndicatorTypes.Net)';
    </script>
    @Scripts.RenderFormat(SiteKeys.ScriptVersion, "~/Scripts/Main/Ftl")
}
